var updIncCord = false;
var Pouploadwd = false;
var PouploadwdforInitials = false;
var isbuttonclicked = false, PlaceholderReviewCount = 0, configcount = 0;
var InitialsCustomized = $("#IsInitialsCustomized").val();
var SelectedInitialsId = "", SelectedSignatureId = "", SignatureCoordinates = "", InitialsCoordinates = "";
function BindInitialsPlaceHolders(pageNumber, PageCount, docType) {
    var SelectedPage, SignPosition, coordinates;
    if (InitialsCustomized != "False") {
        SelectedPage = $('#ddlInitialsPageSelection option:selected').val();
        SignPosition = $('#ddlInitialsPosition option:selected').val();
    }
    else {
        SelectedPage = $("#SelectInitialsPage").val();
        SignPosition = $("#InitialsPosition").val();
        coordinates = $("#InitialsCustomizeCoordinates").val().split(',');
    }
    var height = 0, width = 0;
    //var FinalTop;
    if (SelectedPage == "SPECIFY") {
        var PageNumbers = $("#InitialsPageNumbers").val().split(',');
        var configdetails, coordinates, Left, Width, Height, Top, FinalTop;
        if (updIncCord == true) {
            configdetails = $("#hdnInitialsCoordinates").val();
            coordinates = configdetails.split(',');
            Left = coordinates[0], Width = coordinates[2], Height = coordinates[3];
            Top = $('.documentVisual img').height() - coordinates[1];
            height = (Number(coordinates[1]) - Number(Height));
            width = (Number(Width) - Number(Left));
        }
        else {
            configdetails = GetInitialsCoordinates(SignPosition, docType);
            coordinates = configdetails.split(',');
            Left = coordinates[0], Width = coordinates[2], Height = coordinates[3];
            Top = $('.documentVisual img').height() - coordinates[1];
            FinalTop = Top;
            height = (Number(coordinates[1]) - Number(Height));
            width = (Number(Width) - Number(Left));
        }
        if (InitialsCustomized == "True") {
            for (j = 0; j < PageNumbers.length; j++) {
                if (PageNumbers[j] == pageNumber) {

                    if (coordinates.length > 1) {
                        var Left = coordinates[0], Top = coordinates[1], Width = coordinates[2], Height = coordinates[3];
                    }
                    if (SignPosition == "Customize") {
                        FinalTop = $('.documentVisual img').height() - Top;
                        $('#page_' + pageNumber).append('<div  id="draggableDiv_In_' + 1 + '_1" class="dragDiv Initials" style="left:' + Left + 'px; top:' + FinalTop + 'px; height:' + height + 'px; width:' + width + 'px;"><span class="InImg">Initials</span></div>');
                        $('#draggableDiv_In_' + 1 + '_1').draggable({ disabled: false }).resizable({ disabled: false });
                        $('#draggableDiv_In_' + 1 + '_1').draggable({ containment: "#page_" + pageNumber, scroll: false, stop: function () { UpdateInCoordinates(this); } });
                        $('#draggableDiv_In_' + 1 + '_1').resizable({
                            containment: "#page_" + pageNumber, minHeight: 32,
                            maxHeight: 88,
                            minWidth: 34,
                            maxWidth: 99, stop: function () { UpdateInCoordinates(this); }
                        });

                    }
                    else {
                        Top = $('.documentVisual img').height() - coordinates[1];
                        $('#page_' + pageNumber).append('<div  id="draggableDiv_In_' + 1 + '_1" class="dragDiv Initials" style="left:' + Left + 'px; top:' + Top + 'px; height:' + height + 'px; width:' + width + 'px;"><span class="InImg">Initials</span></div>');
                        $('#draggableDiv_In_' + 1 + '_1').draggable({ disabled: false }).resizable({ disabled: false });
                        $('#draggableDiv_In_' + 1 + '_1').draggable({ containment: "#page_" + pageNumber, scroll: false, stop: function () { UpdateInCoordinates(this); } });
                        $('#draggableDiv_In_' + 1 + '_1').resizable({
                            containment: "#page_" + pageNumber, minHeight: 32,
                            maxHeight: 88,
                            minWidth: 34,
                            maxWidth: 99, stop: function () { UpdateInCoordinates(this); }
                        });
                    }
                }
            }
        }
        else {
            for (j = 0; j < PageNumbers.length; j++) {
                if (PageNumbers[j] == pageNumber || ValidateAllPlaceholders == "True") {
                    var coordinates = $("#InitialsCustomizeCoordinates").val().split(',');
                    var Left = coordinates[0], Top = coordinates[1], Width = coordinates[2], Height = coordinates[3];
                    if (SignPosition == "Customize") {
                        var FinalTop = $('.documentVisual img').height() - Top;
                        height = (Number(Top) - Number(Height));
                        width = (Number(Width) - Number(Left));
                        for (i = 0; i < pageNumber; i++) {
                            $('#page_' + pageNumber).append('<div  id="draggableDiv_In_' + 1 + '_' + PageNumbers[j] + '" class="dragDiv Initials" style="left:' + Left + 'px; top:' + FinalTop + 'px; height:' + height + 'px; width:' + width + 'px;"><span class="InImg">Initials</span></div>');
                        }
                    }
                    else {
                        var config = GetInitialsCoordinates(SignPosition, docType);
                        var coordinates = config.split(',');
                        var Top = $('.documentVisual img').height() - coordinates[1];
                        height = (Number(coordinates[1]) - Number(coordinates[3]));
                        width = (Number(coordinates[2]) - Number(coordinates[0]));
                        $('#page_' + PageNumbers[j]).append('<div  id="draggableDiv_In_' + (j + 1) + '_' + PageNumbers[j] + '" class="dragDiv Initials" style="left:' + coordinates[0] + 'px; top:' + Top + 'px; height:' + height + 'px; width:' + width + 'px;"><span class="InImg">Initials</span></div>');
                        //if (window.Boolean(ValidateAllPlaceholders)) {
                        //    var config = { PageNo: PageNumbers[j], Topvalue: Top, DivId: "draggableDiv_In_" + (j + 1) + "_" + PageNumbers[j] + "~" + PageNumbers[j] };
                        //    IndconfigDetailswithAllPage.push(config);
                        //}
                    }
                }
            }
        }


    }
    else if (SelectedPage == "PAGE LEVEL") {

        var configdetails, coordinates, Left, Width, Height, Top, FinalTop;
        var Configdetails = $("#InitialsPagelevelCordinates").val().split(';');
        var PageNumbers = new Array();
        for (i = 0; i < Configdetails.length; i++) {
            var coordinates = Configdetails[i].split(',');
            var Left = coordinates[1], Top = coordinates[2], Width = coordinates[3], Height = coordinates[4];
            if (InitialsCustomized == "True") {
                if (coordinates[0] == pageNumber) {
                    var FinalTop = $('.documentVisual img').height() - Top;
                    height = (Number(Top) - Number(Height));
                    width = (Number(Width) - Number(Left));
                    $('#page_' + pageNumber).append('<div id="draggableDiv_In_' + 1 + '_' + pageNumber + '" class="dragDiv Initials" style="left:' + Left + 'px; top:' + FinalTop + 'px; height:' + height + 'px; width:' + width + 'px;"><span class="InImg">Initials</span><a href="javascript:void(0);" id="DeleteIn_' + pageNumber + '" class="delInPL" title="Delete"><span></span></a></div>');
                    $('#draggableDiv_In_' + 1 + '_' + pageNumber + '').draggable({ disabled: false }).resizable({ disabled: false });
                    $('#draggableDiv_In_' + 1 + '_' + pageNumber + '').draggable({ containment: "#page_" + pageNumber, scroll: false, stop: function () { UpdateInCoordinates(this); } });
                    $('#draggableDiv_In_' + 1 + '_' + pageNumber + '').resizable({
                        containment: "#page_" + pageNumber, minHeight: 32,
                        maxHeight: 88,
                        minWidth: 34,
                        maxWidth: 99, stop: function () { UpdateInCoordinates(this); }
                    });
                }

            }
            else {
                if (coordinates[0] == pageNumber || InitialsCustomized == "True") {
                    var FinalTop = $('.documentVisual img').height() - Top;
                    height = (Number(Top) - Number(Height));
                    width = (Number(Width) - Number(Left));
                    $('#page_' + coordinates[0]).append('<div cid="draggableDiv_In_' + (i + 1) + '_' + coordinates[0] + '" class="dragDiv Initials" style="left:' + Left + 'px; top:' + FinalTop + 'px; height:' + height + 'px; width:' + width + 'px;"><span class="InImg">Initials</span><a href="javascript:void(0);" id="DeleteIn_' + pageNumber + '" class="delInPL" title="Delete"><span></span></a></div>');
                    //if (window.Boolean(ValidateAllPlaceholders)) {
                    //    var config = { PageNo: coordinates[0], Topvalue: Top, DivId: "draggableDiv_In_" + (i + 1) + "_" + coordinates[0] + "~" + coordinates[0] };
                    //    IndconfigDetailswithAllPage.push(config);
                    //}
                }
            }
        }
    }
    else if (SelectedPage == "FIRST") {
        var configdetails, coordinates, Left, Width, Height, Top;
        if (updIncCord == "true") {
            configdetails = $("#hdnInitialsCoordinates").val();
            coordinates = configdetails.split(',');
            Left = coordinates[0], Width = coordinates[2], Height = coordinates[3];
            Top = $('.documentVisual img').height() - coordinates[1];
            height = (Number(coordinates[1]) - Number(Height));
            width = (Number(Width) - Number(Left));
        }
        else {
            configdetails = GetInitialsCoordinates(SignPosition, docType);
            coordinates = configdetails.split(',');
            Left = coordinates[0], Width = coordinates[2], Height = coordinates[3];
            Top = $('.documentVisual img').height() - coordinates[1];
            height = (Number(coordinates[1]) - Number(Height));
            width = (Number(Width) - Number(Left));
        }

        if (InitialsCustomized == "True") {
            if (pageNumber == 1) {
                $('#page_' + pageNumber).append('<div id="draggableDiv_In_' + 1 + '_1" class="dragDiv Initials" style="left:' + Left + 'px; top:' + Top + 'px; height:' + height + 'px; width:' + width + 'px;"><span class="InImg">Initials</span></div>');
                $('#draggableDiv_In_' + 1 + '_1').draggable({ disabled: false }).resizable({ disabled: false });
                $('#draggableDiv_In_' + 1 + '_1').draggable({ containment: "#page_" + pageNumber, scroll: false, stop: function () { UpdateInCoordinates(this); } });
                $('#draggableDiv_In_' + 1 + '_1').resizable({
                    containment: "#page_" + pageNumber, minHeight: 32,
                    maxHeight: 88,
                    minWidth: 34,
                    maxWidth: 99, stop: function () { UpdateInCoordinates(this); }
                });

            }
        }
        else {
            if (pageNumber == 1) {
                $('#page_' + pageNumber).append('<div id="draggableDiv_In_' + 1 + '_' + pageNumber + '" class="dragDiv Initials" style="left:' + Left + 'px; top:' + Top + 'px; height:' + height + 'px; width:' + width + 'px;"><span class="InImg">Initials</span></div>');
                //if (window.Boolean(ValidateAllPlaceholders)) {
                //    var config = { PageNo: pageNumber, Topvalue: Top, DivId: "draggableDiv_In_" + 1 + "_" + pageNumber + "~" + pageNumber };
                //    IndconfigDetailswithAllPage.push(config);
                //}
            }
        }
    }
    else if (SelectedPage == "LAST") {
        var configdetails, coordinates, Left, Width, Height, Top;
        if (updIncCord == "true") {
            configdetails = $("#hdnInitialsCoordinates").val();;
            coordinates = configdetails.split(',');
            Left = coordinates[0], Width = coordinates[2], Height = coordinates[3];
            Top = $('.documentVisual img').height() - coordinates[1];
            height = (Number(coordinates[1]) - Number(Height));
            width = (Number(Width) - Number(Left));
        }
        else {
            configdetails = GetInitialsCoordinates(SignPosition, docType);
            coordinates = configdetails.split(',');
            Left = coordinates[0], Width = coordinates[2], Height = coordinates[3];
            Top = $('.documentVisual img').height() - coordinates[1];
            height = (Number(coordinates[1]) - Number(Height));
            width = (Number(Width) - Number(Left));
        }
        if (InitialsCustomized == "True") {
            if (pageNumber == PageCount) {
                $('#page_' + pageNumber).append('<div id="draggableDiv_In_' + 1 + '_1" class="dragDiv Initials" style="left:' + Left + 'px; top:' + Top + 'px; height:' + height + 'px; width:' + width + 'px;"><span class="InImg">Initials</span></div>');
                $('#draggableDiv_In_' + 1 + '_1').draggable({ disabled: false }).resizable({ disabled: false });
                $('#draggableDiv_In_' + 1 + '_1').draggable({ containment: "#page_" + pageNumber, scroll: false, stop: function () { UpdateInCoordinates(this); } });
                $('#draggableDiv_In_' + 1 + '_1').resizable({
                    containment: "#page_" + pageNumber, minHeight: 32,
                    maxHeight: 88,
                    minWidth: 34,
                    maxWidth: 99, stop: function () { UpdateInCoordinates(this); }
                });
            }
        }
        else {
            if (pageNumber == PageCount) {
                $('#page_' + pageNumber).append('<div id="draggableDiv_In_' + 1 + '_' + pageNumber + '" class="dragDiv Initials" style="left:' + Left + 'px; top:' + Top + 'px; height:22px; width:24px;"><span class="InImg">Initials</span></div>');
                //if (window.Boolean(ValidateAllPlaceholders)) {
                //    var config = { PageNo: pageNumber, Topvalue: Top, DivId: "draggableDiv_In_" + 1 + "_" + pageNumber + "~" + pageNumber };
                //    IndconfigDetailswithAllPage.push(config);
                //}
            }
        }
    }
    else if (SelectedPage == "ALL") {
        var configdetails, coordinates, Left, Width, Height, Top;
        if (updIncCord == "true") {
            configdetails = $("#hdnInitialsCoordinates").val();;
            coordinates = configdetails.split(',');
            Left = coordinates[0], Width = coordinates[2], Height = coordinates[3];
            Top = $('.documentVisual img').height() - coordinates[1];
            height = (Number(coordinates[1]) - Number(Height));
            width = (Number(Width) - Number(Left));
        }
        else {
            configdetails = GetInitialsCoordinates(SignPosition, docType);
            coordinates = configdetails.split(',');
            Left = coordinates[0], Width = coordinates[2], Height = coordinates[3];
            Top = $('.documentVisual img').height() - coordinates[1];
            height = (Number(coordinates[1]) - Number(Height));
            width = (Number(Width) - Number(Left));
        }


        if (IsCustomized == "True") {

            $('#page_' + pageNumber).append('<div id="draggableDiv_In_' + 1 + '" class="dragDiv Initials" style="left:' + Left + 'px; top:' + Top + 'px; height:' + height + 'px; width:' + width + 'px;"><span class="InImg">Initials</span></div>');
            $('#draggableDiv_In_' + 1).draggable({ containment: "#page_" + pageNumber, scroll: false, stop: function () { UpdateInCoordinates(this); } });
            $('#draggableDiv_In_' + 1).resizable({
                containment: "#page_" + pageNumber, minHeight: 32,
                maxHeight: 88,
                minWidth: 34,
                maxWidth: 99, stop: function () { UpdateInCoordinates(this); }
            });

        }
        else {
            if (window.Boolean(ValidateAllPlaceholders)) {
                for (i = 0; i < PageCount; i++) {
                    $('#page_' + (i + 1)).append('<div  id="draggableDiv_In_' + (i + 1) + '_' + (i + 1) + '" class="dragDiv Initials" style="left:' + Left + 'px; top:' + Top + 'px; height:' + height + 'px; width:' + width + 'px;"><span class="InImg">Initials</span></div>');
                    //if (window.Boolean(ValidateAllPlaceholders)) {
                    //    var config = { PageNo: (i + 1), Topvalue: Top, DivId: "draggableDiv_In_" + (i + 1) + "_" + (i + 1) + "~" + (i + 1) };
                    //    IndconfigDetailswithAllPage.push(config);
                    //}
                }
            }
            else {
                $('#page_' + pageNumber).append('<div  id="draggableDiv_In_' + 1 + '_' + pageNumber + '" class="dragDiv Initials" style="left:' + Left + 'px; top:' + Top + 'px; height:' + height + 'px; width:' + width + 'px;"><span class="InImg">Initials</span></div>');
                //if (window.Boolean(ValidateAllPlaceholders)) {
                //    var config = { PageNo: pageNumber, Topvalue: Top, DivId: "draggableDiv_In_" + 1 + "_" + pageNumber + "~" + pageNumber };
                //    IndconfigDetailswithAllPage.push(config);
                //}
            }

        }
    }
    else if (SelectedPage == "EVEN") {
        var PDetails = new Array();
        for (i = 0; i < PageCount; i++) {
            if (((i + 1) % 2) == 0) {
                PDetails.push((i + 1));
            }
        }
        var configdetails, coordinates, Left, Width, Height, Top;
        if (updIncCord == "true") {
            configdetails = $("#hdnInitialsCoordinates").val();;
            coordinates = configdetails.split(',');
            Left = coordinates[0], Width = coordinates[2], Height = coordinates[3];
            Top = $('.documentVisual img').height() - coordinates[1];
            height = (Number(coordinates[1]) - Number(Height));
            width = (Number(Width) - Number(Left));
        }
        else {
            configdetails = GetInitialsCoordinates(SignPosition, docType);
            coordinates = configdetails.split(',');
            Left = coordinates[0], Width = coordinates[2], Height = coordinates[3];
            Top = $('.documentVisual img').height() - coordinates[1];
            height = (Number(coordinates[1]) - Number(Height));
            width = (Number(Width) - Number(Left));
        }
        if (InitialsCustomized == "True") {
            for (j = 0; j < PDetails.length; j++) {
                if (PDetails[j] == pageNumber) {
                    $('#page_' + pageNumber).append('<div  id="draggableDiv_In_' + 1 + '_' + PDetails[j] + '" class="dragDiv Initials" style="left:' + Left + 'px; top:' + Top + 'px; height:' + height + 'px; width:' + width + 'px;"><span class="InImg">Initials</span></div>');
                    $('#draggableDiv_In_' + 1 + '_' + PDetails[j]).draggable({ disabled: false }).resizable({ disabled: false });
                    $('#draggableDiv_In_' + 1 + '_' + PDetails[j]).draggable({ containment: "#page_" + pageNumber, scroll: false, stop: function () { UpdateInCoordinates(this); } });
                    $('#draggableDiv_In_' + 1 + '_' + PDetails[j]).resizable({
                        containment: "#page_" + pageNumber, minHeight: 32,
                        maxHeight: 88,
                        minWidth: 34,
                        maxWidth: 99, stop: function () { UpdateInCoordinates(this); }
                    });
                }
            }
        }
        else {
            for (j = 0; j < PDetails.length; j++) {
                if (PDetails[j] == pageNumber || ValidateAllPlaceholders == "True") {
                    $('#page_' + PDetails[j]).append('<div  id="draggableDiv_In_' + (j + 1) + '_' + PDetails[j] + '" class="dragDiv Initials" style="left:' + Left + 'px; top:' + Top + 'px; height:' + height + 'px; width:' + width + 'px;"><span class="InImg">Initials</span></div>');
                    //if (window.Boolean(ValidateAllPlaceholders)) {
                    //    var config = { PageNo: PDetails[j], Topvalue: Top, DivId: "draggableDiv_In_" + (j + 1) + "_" + PDetails[j] + "~" + PDetails[j] };
                    //    IndconfigDetailswithAllPage.push(config);
                    //}
                }
            }
        }
    }
    else {
        var PDetails = new Array();
        for (i = 0; i < PageCount; i++) {
            if (((i + 1) % 2) != 0) {
                PDetails.push((i + 1));
            }
        }
        var configdetails, coordinates, Left, Width, Height, Top;
        if (updIncCord == "true") {
            configdetails = $("#hdnInitialsCoordinates").val();;
            coordinates = configdetails.split(',');
            Left = coordinates[0], Width = coordinates[2], Height = coordinates[3];
            Top = $('.documentVisual img').height() - coordinates[1];
            height = (Number(coordinates[1]) - Number(Height));
            width = (Number(Width) - Number(Left));
            //FinalTop = $('.documentVisual img').height() - Top;
        }
        else {
            configdetails = GetInitialsCoordinates(SignPosition, docType);
            coordinates = configdetails.split(',');
            Left = coordinates[0], Width = coordinates[2], Height = coordinates[3];
            Top = $('.documentVisual img').height() - coordinates[1];
            height = (Number(coordinates[1]) - Number(Height));
            width = (Number(Width) - Number(Left));
        }
        if (InitialsCustomized == "True") {
            for (j = 0; j < PDetails.length; j++) {
                if (PDetails[j] == pageNumber) {
                    $('#page_' + pageNumber).append('<div  id="draggableDiv_In_' + 1 + '_' + PDetails[j] + '" class="dragDiv Initials" style="left:' + Left + 'px; top:' + Top + 'px; height:' + height + 'px; width:' + width + 'px;"><span class="InImg">Initials</span></div>');
                    $('#draggableDiv_In_' + 1 + '_' + PDetails[j]).draggable({ disabled: false }).resizable({ disabled: false });
                    $('#draggableDiv_In_' + 1 + '_' + PDetails[j]).draggable({ containment: "#page_" + pageNumber, scroll: false, stop: function () { UpdateInCoordinates(this); } });
                    $('#draggableDiv_In_' + 1 + '_' + PDetails[j]).resizable({
                        containment: "#page_" + pageNumber, minHeight: 32,
                        maxHeight: 88,
                        minWidth: 34,
                        maxWidth: 99, stop: function () { UpdateInCoordinates(this); }
                    });
                }
            }
        }
        else {
            for (j = 0; j < PDetails.length; j++) {
                if (PDetails[j] == pageNumber || ValidateAllPlaceholders == "True") {
                    $('#page_' + PDetails[j]).append('<div  id="draggableDiv_In_' + (j + 1) + '_' + PDetails[j] + '" class="dragDiv Initials" style="left:' + Left + 'px; top:' + Top + 'px; height:' + height + 'px; width:' + width + 'px;"><span class="InImg">Initials</span></div>');
                    //if (window.Boolean(ValidateAllPlaceholders)) {
                    //    var config = { PageNo: PDetails[j], Topvalue: Top, DivId: "draggableDiv_In_" + (j + 1) + "_" + PDetails[j] + "~" + PDetails[j] };
                    //    IndconfigDetailswithAllPage.push(config);
                    //}
                }
            }
        }
    }
    var InitialsVisualizationId = parseInt($("#hdnInitialsImageOption").val());
    var InitialImage = $("#InitialsImage").val();
    if (InitialImage != "" && InitialImage != undefined) {
        var initialimagedata = "";
        if (InitialsVisualizationId == 1) {
            initialimagedata = '<img style="box-shadow: none !important;height: 100%;" src="' + InitialImage + '">';
        }
        else {
            initialimagedata = '<img style="width: inherit;box-shadow: none !important;height: 100%;" src="' + InitialImage + '">';
        }
        $(".Initials img").remove();
        $(".Initials span").html('');
        $(".Initials").append(initialimagedata);
        $(".dragDiv.Initials").addClass("focused");
    }
    if (ValidateAllPlaceholders == "True") {
        GetAllPlaceholdersID();
    }
}
$("#btnInResetbrowse").on("click", function () {
    $("#txtInitialsimage,#InitialsImage").val('');
    $("#lblIniailserrormessage").text("");
});

function GetInitialsCoordinates(selectedSignaturePosition, docType) {

    var InCoordinates = "";
    $("#ddlInitialsPosition").val(selectedSignaturePosition);
    var ddlInitialsPageSelection = $("#SelectInitialsPage").val();
    $("#ddlInitialsPageSelection").val(ddlInitialsPageSelection);
    var Height = 32, Width = 34;
    var imagewidth = parseInt($('.documentVisual img').width());
    var actualPageHeight = 0;
    prHeight = $('.documentVisual img').height();
    actualPageHeight = $('.documentVisual img')[0].offsetHeight;
    switch (selectedSignaturePosition) {
        case "Top-Left":
            $('#txtLeft').attr('disabled', true);
            Left = defaultLeftPxValue; TopDetails = actualPageHeight - defaultTopPxValue;
            Top = prHeight - TopDetails;
            //Left = 7; TopDetails = docType == "Portrait" ? 839 : 590;
            //var top1 = $('.documentVisual img').height()
            //Top = prHeight - TopDetails;
            return InCoordinates = Left + "," + TopDetails + "," + (parseInt(Left) + parseInt(Width)) + "," + (parseInt(TopDetails) - parseInt(Height));
            break;
        case "Top-Center":
            Left = ((($('.documentVisual img')[0].offsetWidth / 2) - (defaultInWidthPxValue / 2)) + defaultLeftPxValue) + $('.documentVisual img')[0].offsetLeft;
            TopDetails = actualPageHeight - defaultTopPxValue;
            Top = prHeight - TopDetails;
            return InCoordinates = Left + "," + TopDetails + "," + (parseInt(Left) + parseInt(Width)) + "," + (parseInt(TopDetails) - parseInt(Height));
            break;

        case "Top-Right":
            Left = (($('.documentVisual img')[0].offsetWidth - defaultInWidthPxValue) - defaultLeftPxValue) - $('.documentVisual img')[0].offsetLeft;
            TopDetails = actualPageHeight - defaultTopPxValue;
            Top = prHeight - TopDetails;
            return InCoordinates = Left + "," + TopDetails + "," + (parseInt(Left) + parseInt(Width)) + "," + (parseInt(TopDetails) - parseInt(Height));
            break;
        case "Middle-Left":
            Left = defaultLeftPxValue; TopDetails = (Number(prHeight) + defaultInHeightPxValue) / 2;
            Top = prHeight - TopDetails;
            return InCoordinates = Left + "," + TopDetails + "," + (parseInt(Left) + parseInt(Width)) + "," + (parseInt(TopDetails) - parseInt(Height));
            break;
        case "Middle-Center":
            Left = ((($('.documentVisual img')[0].offsetWidth / 2) - (defaultInWidthPxValue / 2)) + defaultLeftPxValue) + $('.documentVisual img')[0].offsetLeft;
            TopDetails = (Number(prHeight) + defaultInHeightPxValue) / 2;
            Top = prHeight - TopDetails;
            return InCoordinates = Left + "," + TopDetails + "," + (parseInt(Left) + parseInt(Width)) + "," + (parseInt(TopDetails) - parseInt(Height));
            break;
        case "Middle-Right":
            Left = (($('.documentVisual img')[0].offsetWidth - defaultInWidthPxValue) - defaultLeftPxValue) - $('.documentVisual img')[0].offsetLeft;
            TopDetails = (Number(prHeight) + defaultInHeightPxValue) / 2;
            Top = prHeight - TopDetails;
            return InCoordinates = Left + "," + TopDetails + "," + (parseInt(Left) + parseInt(Width)) + "," + (parseInt(TopDetails) - parseInt(Height));
            break;
        case "Bottom-Left":
            Left = defaultLeftPxValue;
            TopDetails = defaultInHeightPxValue + defaultBottomPxValue;
            Top = prHeight - TopDetails;
            return InCoordinates = Left + "," + TopDetails + "," + (parseInt(Left) + parseInt(Width)) + "," + (parseInt(TopDetails) - parseInt(Height));
            break;
        case "Bottom-Center":
            Left = ((($('.documentVisual img')[0].offsetWidth / 2) - (defaultInWidthPxValue / 2)) + defaultLeftPxValue) + $('.documentVisual img')[0].offsetLeft;
            TopDetails = defaultInHeightPxValue + defaultBottomPxValue;
            Top = prHeight - TopDetails;
            return InCoordinates = Left + "," + TopDetails + "," + (parseInt(Left) + parseInt(Width)) + "," + (parseInt(TopDetails) - parseInt(Height));
            break;
        case "Bottom-Right":
            Left = (($('.documentVisual img')[0].offsetWidth - defaultInWidthPxValue) - defaultLeftPxValue) - $('.documentVisual img')[0].offsetLeft;
            TopDetails = defaultInHeightPxValue + defaultBottomPxValue;
            Top = prHeight - TopDetails;
            return InCoordinates = Left + "," + TopDetails + "," + (parseInt(Left) + parseInt(Width)) + "," + (parseInt(TopDetails) - parseInt(Height));
            break;
        default:
            return InCoordinates = $("#hdnCustomizecoordinates").val();
            break;
    }
}

function GetInitialsCoordinatesforSigning() {
    var Pagelength = $("#hdnNoOfPages").val();
    var PageNumber = "";
    var SelectedValue, SignPosition;
    if (InitialsCustomized != "False") {
        SelectedValue = $('#ddlInitialsPageSelection option:selected').val();
        SignPosition = $('#ddlInitialsPosition option:selected').val()
    }
    else {
        SelectedValue = $("#SelectInitialsPage").val();
        SignPosition = $("#InitialsPosition").val();
    }
    if (SelectedValue == "FIRST") {
        PageNumber = 1;
    }
    else if (SelectedValue == "ALL") {
        for (i = 0; i < parseInt(Pagelength); i++) {
            PageNumber += (i + 1) + ",";
        }
    }
    else if (SelectedValue == "EVEN") {
        for (i = 0; i < Pagelength; i++) {
            if (((i + 1) % 2) == 0) {
                PageNumber += (i + 1) + ",";
            }
        }
    }
    else if (SelectedValue == "ODD") {
        for (i = 0; i < Pagelength; i++) {
            if (((i + 1) % 2) != 0) {
                PageNumber += (i + 1) + ",";
            }
        }
    }
    else if (SelectedValue == "LAST") {
        PageNumber = Pagelength;
    }
    var docType = $("#hdnDocType").val();
    var IniCoordinates = "";
    //Coordinates = GetCoordinates($("#hdnSigPosition").val(), docType);
    if (InitialsCustomized == "True") {
        IniCoordinates = $("#hdnInitialsCoordinates").val();
        if (IniCoordinates == "") {
            IniCoordinates = $("#InitialsCustomizeCoordinates").val();
            if (IniCoordinates == "") {
                IniCoordinates = GetInitialsCoordinates(SignPosition, docType);
            }
        }
    }
    else {
        IniCoordinates = GetInitialsCoordinates(SignPosition, docType);
    }
    if (SelectedValue == "SPECIFY") {
        PageNumber = $("#InitialsPageNumbers").val();
    }
    else if (SelectedValue == "PAGE LEVEL") {
        PageNumber = $("#InitialsPagelevelCordinates").val();
        IniCoordinates = $("#InitialsPagelevelCordinates").val();
    }
    var ImageData = "";
    var SignatureImg = $("#InitialsImage").val();
    if (SignatureImg == "" || SignatureImg == null) {
        if ($("#hdnInitialsImageOption").val() == 1) {
            ImageData = $("#InitialsImage").val();
        }
        else if ($("#hdnInitialsImageOption").val() == 2) {
            if ($("#divInitials").jSignature('getData', 'native') != 0) {
                ImageData = $('#divInitials').jSignature('getData');
            }
            else {
                ImageData = "";
            }
        }
        else if ($("#hdnInitialsImageOption").val() == 3) {
            ImageData = $("#InitialsImage").val();
        }
    } else {
        ImageData = SignatureImg;
    }
    if (ImageData == "") {

        ShowHidePleaseWait('N');
        $('#imgFollow').hide();
        $("#msgcontent").attr("class", "info");
        if ($("#hdnInitialsImageOption").val() == "1") {
            if ($("#SelectFontOption").val() == "True") {
                $('#msgcontent').html("Please select any one font option.");
            }
        } else {
            if ($("#hdnInitialsImageOption").val() == "2") {
                if ($("#DrawSignatureOption").val() == "True") {
                    $('#msgcontent').html("Please Draw an image.");
                }
            } else if ($("#hdnInitialsImageOption").val() == "3") {
                if ($("#UploadSignatureOption").val() == "True") {
                    $('#msgcontent').html("Please upload an image with maximum of 200kb and minimum 100kb");
                }
            }
        }
        //$('#msgcontent').html("Please select any of the signature options");
        $("#btnmsgcancel").hide();
        $(".alertWindow").css({ 'display': "block" });
        $('#btnmsgok').html('OK');
        $('#btnmsgok').attr("href", "javascript:Returncontrol('Y','');");
        return false;
    }

    var InitialsObj = { ImageData: ImageData, Coordinates: IniCoordinates, PageNumber: PageNumber, SelectedValue: SelectedValue };
    return InitialsObj;

}



function call(e) {
    if (document.getElementById('txtFullName').value.length == 0) {
        if (e.keyCode == 32) {
            e.preventDefault();
        }
    }
}
function callIn(e) {
    if (document.getElementById('txtInitials').value.length == 0) {
        if (e.keyCode == 32) {
            e.preventDefault();
        }
    }
}
$("#txtInitials").blur(function () {
    var text = $("#txtInitials").val();
    if (text == "") {
        $("#txtInitials").val(DisplayName)
        $(".font-In").text(DisplayName);
    }
    else {
        $('.font-In').html(text);
    }
});
$("#Initialsdropdown .sign-font-option .imgdetails.In").on("click", function () {
    ShowHidePleaseWait('Y');
    var s = $(this).attr('id');
    var id = s.split('_')[2];
    $("#rbt_In_" + id).prop("checked", true);
    var selectedId = $("#Initialsdropdown .selected ").attr('id');
    $("#" + selectedId).removeClass("selected");
    $("#" + s).addClass("selected");
    html2canvas(document.getElementById("lbl_In_" + id + ""), {
        onrendered: function (canvas) {
            base64string = canvas.toDataURL("image/png");
            $("#hdnInitialsImageOption").val(1);
            $("#InitialsImage").val(base64string);
            ShowHidePleaseWait('N');
        }
    });
});
$("#btnResetIn").on("click", function () {
    $('input[name="backimgIn"]').attr('checked', false);
    $("#Initialsdropdown .sign-font-option li .In").removeClass("selected");
    //$("#hdnSignatureImageOption").val("");
});
$("#btnInResetbrowse").on("click", function () {
    //$("#txtsignatureimage").val('');
    $("#lblerrormessage").text("");
    $("input[id='btnInitialsImage']").val("");
    //$("#hdnSignatureImageOption").val("");
});
$('#Initialsdropdown .signing-tab .innertab-In-link').on("click", function () {
    var s = $(this).attr('id'),
        t = s.split("innertabLink_In_");
    if (s == "innertabLink_In_1") {
        innertabLink = "innertabLink_In_1";
        $('input[name="backimgIn"]').attr('checked', false);
        $("#Initialsdropdown .sign-font-option li .In").removeClass("selected");
        $(".font-In").text(DisplayName.substr(0, 2));
        $("#txtInitials").val(DisplayName.substr(0, 2));
        $("#hdnInitialsImageOption").val(1);
        $('#divInitials canvas').remove();
        //$('#SignatureImage').val("");
    }
    if (s == "innertabLink_In_2") {
        innertabLink = "innertabLink_In_2";
        var CanvasLength = $("#divInitials canvas").length;
        $("#hdnInitialsImageOption").val(2);
    }
    if (s == "innertabLink_In_3") {
        innertabLink = "innertabLink_In_3";
        $("#lblerrormessage").text("");
        $("#btnInitialsImage").val('');
        $('#divInitials canvas').remove();
        $("#hdnInitialsImageOption").val(3);
        //$('#hdnFilePath').val("");
    }
    $(".innertab-panel").hide();
    $("#innertabContent_In_" + t[1]).show();
    $(".innertab-In-link").removeClass("active");
    $("#innertabLink_In_" + t[1]).addClass("active");
    if (CanvasLength == 0) {
        $("#divInitials").jSignature({
            'background-color': 'transparent',
            'decor-color': 'transparent',
            'lineWidth': 3
        });
    }
    if (s == "innertabLink_2") {
        innertabLink = "innertabLink_In_2";
        $('#divInitials').jSignature('reset');
    }
    var id = $(".innertab-In-link.active").attr('id').split('_')[2];
    $("#innertabContent_In_" + id).show();
});

$('body').on("click", "#btncancelInitials,#btncloseInitialsWindow", function () {
    $("#Initialsdropdown").modal('hide');
});

$('#btnInitialsImage').fileupload({
    maxFileSize: 5000000,
    url: SaveInitialImageURL,
    formData: function (form) {
        return [{ name: "__RequestVerificationToken", value: $('[name= "__RequestVerificationToken"]').val() }];
    },
    add: function (e, data) {
        if (data.files[0].type != "image/jpeg" && data.files[0].type != "image/png") {
            $("#lblerrormessage").text("NOTE: Only .jpg..jpeg and .png files can be set as Signature Image.").attr('style', 'color: red;');
            //$("#hdnSignatureImageOption").val("");
            return false;
        }
        if (data.files[0].size <= AttachmentSize) {
            data.submit();
        }
        else {
            $("#lblIniailserrormessage").text(MessageForAttachmentSize).attr('style', 'color: red;');
            //$("#hdnSignatureImageOption").val("");
            return false;
        }
    },
    success: function (data, status) {
        if (data.status == 1) {
            $('#txtInitialsimage').val(data.FileName);
            $('#InitialsImage').val(data.Fullpath);
            //$("input[name='SignatureImage']").val("");
            //$("#hdnSignatureImageOption").val(3);
            // $("#hdnFilePath").val(data.FileName);
            $("#lblIniailserrormessage").text("");
        }
        else {
            $("#lblIniailserrormessage").text("Invalid file format.").attr('style', 'color: red;');
            $("#hdnSignatureImageOption").val("");
            return false;
        }
    },
    done: function (e, data) {
    },
    error: function (error) {
    }
});

function UpdateInCoordinates(divBox) {

    var id = divBox.id.replace('draggableDiv_In_', '');
    var currentId = id.split('_')[0];
    var selectedSignaturePosition = $('#ddlInitialsPageSelection option:selected').val();
    if (selectedSignaturePosition == "PAGE LEVEL") {
        var signatorylength = $(".Initials").length;
        var config = "";
        for (i = 1; i <= signatorylength; i++) {
            var Page = $('#fieldInPagination_' + i + ' option:selected').val();
            var id = $('#draggableDiv_In_' + currentId + '_' + i)[0];
            var Width = id.offsetWidth;
            var Height = id.offsetHeight;
            var Left = id.offsetLeft;
            var Top = id.offsetTop;
            Top = $('.documentVisual img').height() - Top;
            Height = (Number(Top) - Number(Height));
            Width = (Number(Left) + Number(Width));
            config += Page + ',' + Left + ',' + Top + ',' + Width + ',' + Height + ';';

            //Coordinates = Left + ',' + Top + ',' + Width + ',' + Height;
            //updCord = "true";
            //$("#hdnInitialsCoordinates").val(Coordinates);
            //$("#ddlInitialsPosition").val("CUSTOMIZE");
            //customselectPage = "true";
        }

        Coordinates = Left + ',' + Top + ',' + Width + ',' + Height;
        updIncCord = "true";
        $("#hdnInitialsCoordinates").val(config);
        $("#InitialsPagelevelCordinates").val(config);
        //customInselectPage = "true";

    }
    else {
        // if (configDetails[4] == "CUSTOMIZE") {
        if (selectedSignaturePosition == "ALL" || selectedSignaturePosition == "EVEN" || selectedSignaturePosition == "EVEN" || selectedSignaturePosition == "ODD" || selectedSignaturePosition == "SPECIFY") {
            var Width = parseInt(divBox.offsetWidth);
            var Height = parseInt(divBox.offsetHeight);
            var Left = divBox.offsetLeft;
            var Top = divBox.offsetTop;
            $('.Initials').attr("style", "left: " + Left + "px; top:" + Top + "px; width: " + Width + "px; height:" + Height + "px; position: absolute;");
        }
        //  }
        var Width = parseInt(divBox.offsetWidth);
        var Height = parseInt(divBox.offsetHeight);
        var Left = divBox.offsetLeft;
        var Top = divBox.offsetTop;
        $("#ddlInitialsPosition").val("CUSTOMIZE");
        //  $('.Signatory' + currentId + '').attr("style", "left: " + Left + "px; top:" + Top + "px; width: " + Width + "px; height:" + Height + "px; position: absolute;");
        $("#txtLeft").val(Left);
        $("#txtTop").val(Top);
        $("#txtHeight").val(Height);
        $("#txtWidth").val(Width);
        Top = $('.documentVisual img').height() - Top;
        Height = (Number(Top) - Number(Height));
        Width = (Number(Left) + Number(Width));
        //var newConfigDetails = configDetails[0] + "_" + configDetails[1] + "_" + configDetails[2] + "_" + configDetails[3] + "_" + "CUSTOMIZE" + "_" + configDetails[5] + "_" + Left + "_" + Top + "_" + Width + "_" + Height + "_" + configDetails[10] + "_" + configDetails[11] + "_" + configDetails[12];
        //$('#hdnconfig_' + currentId + '_' + docid + '').val(newConfigDetails);
        $(".Initials").draggable({ disabled: false }).resizable({ disabled: false });

        Coordinates = Left + ',' + Top + ',' + Width + ',' + Height;
        updCord = "true";
        $("#hdnInitialsCoordinates").val(Coordinates);
        $("#ddlInitialsPosition").val("CUSTOMIZE");
        // customselectPage = "true";
    }
    if (ValidateAllPlaceholders == "True") {
        GetAllPlaceholdersID();
    }
}

$('#ddlInitialsPageSelection').change(function () {

    var Left, Top, Height, Width;
    var SelectedValue = $('#ddlInitialsPageSelection option:selected').val();
    var pageCount = $("#hdnTotalPages").val(); //var pageCount = $('.documentVisual').length;
    var PageNo = "";
    var imagewidth = parseInt($('.documentVisual img').width());
    if (SelectedValue == "FIRST") {
        PageNo = 1;
        $('#divInitilasPageNumber').hide();
        $("#Initialsposition").show();
        $("#pageLevelIn").hide();
    }
    else if (SelectedValue == "ALL") {
        for (i = 0; i < pageCount; i++) {
            PageNo += (i + 1) + ",";
        }
        $('#divInitilasPageNumber').hide();
        $("#Initialsposition").show();
        $("#pageLevelIn").hide();
    }
    else if (SelectedValue == "EVEN") {
        for (i = 0; i < pageCount; i++) {
            if (((i + 1) % 2) == 0) {
                PageNo += (i + 1) + ",";
            }
        }
        $('#divInitilasPageNumber').hide();
        $("#Initialsposition").show();
        $("#pageLevelIn").hide();
    }
    else if (SelectedValue == "ODD") {
        for (i = 0; i < pageCount; i++) {
            if (((i + 1) % 2) != 0) {
                PageNo += (i + 1) + ",";
            }
        }
        $('#divInitilasPageNumber').hide();
        $("#Initialsposition").show();
        $("#pageLevelIn").hide();
    }
    else if (SelectedValue == "LAST") {
        PageNo = pageCount;
        $('#divInitilasPageNumber').hide();
        $("#Initialsposition").show();
        $("#pageLevelIn").hide();
    }
    else {
        PageNo = $('#txtInitialsPageNumbers').val();
    }
    if (SelectedValue == "PAGE LEVEL") {
        $('#InitialsPageLevels').empty();
        $('#divInitilasPageNumber').hide();
        $("#divCoordinates").hide();
        $("#Initialsposition").hide();
        $("#pageLevelIn").show();
        var IncurrentId = 1;
        $('.Initials').remove();
        $("#PLevelProfileIn").show();
        CreatePageLevelInitials();

    }
    else if (SelectedValue == "SPECIFY") {
        PageNo = $("#txtInitialsPageNumbers").val();
        $("#txtInitialsPageNumbers").val("");
        $('#divInitilasPageNumber').show();
        $("#pageLevelIn").hide();
        $("#Initialsposition").show();

    }
    else {
        $('#txtInitialsPageNumbers').val("");
        $("#divInitilasPageNumber").hide();
        $('.field-validation-error')
            .removeClass('field-validation-error')
            .addClass('field-validation-valid');
        $('.input-validation-error')
            .removeClass('input-validation-error')
            .addClass('valid');
        $(".field-validation-error").empty();
        $('.field-validation-valid span').html('');
        $("#otherLevel").show();
        $("#pageLevelIn").hide();


        var selectedSignaturePosition = $('#ddlInitialsPosition option:selected').val();
        if (selectedSignaturePosition == "CUSTOMIZE") {
            //$('#txtTop, #txtHeight, #txtWidth, #txtLeft').attr('disabled', true);
            Left = 7; TopDetails = docType == "Portrait" ? 839 : 593; Height = 32; Width = 34;
            Top = $('.documentVisual img').height() - TopDetails;
            Height = (Number(TopDetails) - Number(Height));
            Width = (Number(Left) + Number(Width));
            $("#txtLeft").val(Left);
            $("#txtTop").val(TopDetails);
            $("#txtHeight").val(Height);
            $("#txtWidth").val(Width);

            var NewHeight = 32;
            var NewWidth = 34;
            if (SelectedValue == "FIRST") {
                $(".Initials").remove();
                $('#page_' + PageNo).append('<div id="draggableDiv_In_' + 1 + '_1" class="dragDiv Initials" style="left:' + Left + 'px; top:' + Top + 'px; height:' + NewHeight + 'px; width:' + NewWidth + 'px;"><span class="InImg">Initials</span></div>');
                //$('#draggableDiv_'+1).draggable({ disabled: false }).resizable({ disabled: false });
                $('#draggableDiv_In_' + 1 + '_1').draggable({ containment: "#page_1", scroll: false, stop: function () { UpdateInCoordinates(this); } });
                $('#draggableDiv_In_' + 1 + '_1').resizable({
                    containment: "#page_1", minHeight: 32,
                    maxHeight: 88,
                    minWidth: 34,
                    maxWidth: 99, stop: function () { UpdateInCoordinates(this); }
                });
            }
            else if (SelectedValue == "LAST") {
                $(".Initials").remove();
                $('#page_' + PageNo).append('<div id="draggableDiv_In_' + 1 + '_1" class="dragDiv Initials" style="left:' + Left + 'px; top:' + Top + 'px; height:' + NewHeight + 'px; width:' + NewWidth + 'px;"><span class="InImg">Initials</span></div>');
                // $('#draggableDiv_' + 1).draggable({ disabled: false }).resizable({ disabled: false });
                $('#draggableDiv_In_' + 1 + '_1').draggable({ containment: "#page_" + PageNo, scroll: false, stop: function () { UpdateInCoordinates(this); } });
                $('#draggableDiv_In_' + 1 + '_1').resizable({
                    containment: "#page_" + PageNo, minHeight: 32,
                    maxHeight: 88,
                    minWidth: 34,
                    maxWidth: 99, stop: function () { UpdateInCoordinates(this); }
                });
            }
            else {
                var PageNumberDetails = PageNo.split(',');
                $(".Initials").remove();
                for (i = 0; i < PageNumberDetails.length - 1; i++) {
                    $('#page_' + PageNumberDetails[i]).append('<div  id="draggableDiv_In_' + 1 + '_' + (i + 1) + '" class="dragDiv Initials" style="left:' + Left + 'px; top:' + Top + 'px;  height:' + NewHeight + 'px; width:' + NewWidth + 'px;"><span class="InImg">Initials</span></div>');
                    //$('#draggableDiv_' + 1 ).draggable({ disabled: false }).resizable({ disabled: false });
                    $('#draggableDiv_In_' + 1 + '_' + (i + 1) + '').draggable({ containment: "#page_" + PageNumberDetails[i], scroll: false, stop: function () { UpdateInCoordinates(this); } });
                    $('#draggableDiv_In_' + 1 + '_' + (i + 1) + '').resizable({
                        containment: "#page_" + PageNumberDetails[i], minHeight: 32,
                        maxHeight: 88,
                        minWidth: 34,
                        maxWidth: 99, stop: function () { UpdateInCoordinates(this); }
                    });
                }
            }
            Coordinates = Left + ',' + Top + ',' + Width + ',' + Height;
            //updCord = "true";
            $("#hdnInitialsCoordinates").val(Coordinates);
            customselectPage = "true";
        }
        else {
            prHeight = $('.documentVisual img').height();
            var actualPageHeight = $('.documentVisual img')[0].offsetHeight;
            Height = 32; Width = 34;
            if (selectedSignaturePosition == "Top-Left") {
                $('#txtLeft').attr('disabled', true);
                Left = defaultLeftPxValue; TopDetails = actualPageHeight - defaultTopPxValue;
                Top = prHeight - TopDetails;
                var top1 = $('.documentVisual img').height()
                Top = prHeight - TopDetails;
                $("#txtLeft").val(Left);
                $("#txtTop").val(TopDetails);
                $("#txtHeight").val(Height);
                $("#txtWidth").val(Width);

            }
            else if (selectedSignaturePosition == "Top-Center") {
                Left = ((($('.documentVisual img')[0].offsetWidth / 2) - (defaultInWidthPxValue / 2)) + defaultLeftPxValue) + $('.documentVisual img')[0].offsetLeft;
                TopDetails = actualPageHeight - defaultTopPxValue;
                Top = prHeight - TopDetails;
                $("#txtLeft").val(Left);
                $("#txtTop").val(TopDetails);
                $("#txtHeight").val(Height);
                $("#txtWidth").val(Width);

            }
            else if (selectedSignaturePosition == "Top-Right") {
                Left = (($('.documentVisual img')[0].offsetWidth - defaultInWidthPxValue) - defaultLeftPxValue) - $('.documentVisual img')[0].offsetLeft;
                TopDetails = actualPageHeight - defaultTopPxValue;
                Top = prHeight - TopDetails;
                $("#txtLeft").val(Left);
                $("#txtTop").val(TopDetails);
                $("#txtHeight").val(Height);
                $("#txtWidth").val(Width);
            }
            else if (selectedSignaturePosition == "Middle-Left") {
                Left = defaultLeftPxValue; TopDetails = (Number(prHeight) + defaultInHeightPxValue) / 2;
                Top = prHeight - TopDetails;
                $("#txtLeft").val(Left);
                $("#txtTop").val(TopDetails);
                $("#txtHeight").val(Height);
                $("#txtWidth").val(Width);
            }
            else if (selectedSignaturePosition == "Middle-Center") {
                Left = ((($('.documentVisual img')[0].offsetWidth / 2) - (defaultInWidthPxValue / 2)) + defaultLeftPxValue) + $('.documentVisual img')[0].offsetLeft;
                TopDetails = (Number(prHeight) + defaultInHeightPxValue) / 2;
                Top = $('.documentVisual img').height() - TopDetails;
                $("#txtLeft").val(Left);
                $("#txtTop").val(TopDetails);
                $("#txtHeight").val(Height);
                $("#txtWidth").val(Width);
            }
            else if (selectedSignaturePosition == "Middle-Right") {
                Left = (($('.documentVisual img')[0].offsetWidth - defaultInWidthPxValue) - defaultLeftPxValue) - $('.documentVisual img')[0].offsetLeft;
                TopDetails = (Number(prHeight) + defaultInHeightPxValue) / 2;
                Top = $('.documentVisual img').height() - TopDetails;
                $("#txtLeft").val(Left);
                $("#txtTop").val(TopDetails);
                $("#txtHeight").val(Height);
                $("#txtWidth").val(Width);
            }
            else if (selectedSignaturePosition == "Bottom-Left") {
                Left = defaultLeftPxValue;
                TopDetails = defaultInHeightPxValue + defaultBottomPxValue;
                Top = $('.documentVisual img').height() - TopDetails;
                $("#txtLeft").val(Left);
                $("#txtTop").val(TopDetails);
                $("#txtHeight").val(Height);
                $("#txtWidth").val(Width);
            }
            else if (selectedSignaturePosition == "Bottom-Center") {
                Left = ((($('.documentVisual img')[0].offsetWidth / 2) - (defaultInWidthPxValue / 2)) + defaultLeftPxValue) + $('.documentVisual img')[0].offsetLeft;
                TopDetails = defaultInHeightPxValue + defaultBottomPxValue;
                Top = prHeight - TopDetails;
                $("#txtLeft").val(Left);
                $("#txtTop").val(TopDetails);
                $("#txtHeight").val(Height);
                $("#txtWidth").val(Width);
            }
            else if (selectedSignaturePosition == "Bottom-Right") {
                Left = (($('.documentVisual img')[0].offsetWidth - defaultInWidthPxValue) - defaultLeftPxValue) - $('.documentVisual img')[0].offsetLeft;
                TopDetails = defaultInHeightPxValue + defaultBottomPxValue;
                Top = prHeight - TopDetails;
                $("#txtLeft").val(Left);
                $("#txtTop").val(TopDetails);
                $("#txtHeight").val(Height);
                $("#txtWidth").val(Width);
            }

            var PageNumberDetail = "";
            if (SelectedValue == "FIRST") {
                $(".Initials").remove();
                $('#page_' + PageNo).append('<div id="draggableDiv_In_' + 1 + '_1" class="dragDiv Initials" style="left:' + Left + 'px; top:' + Top + 'px; height:' + Height + 'px; width:' + Width + 'px;"><span class="InImg">Initials</span></div>');
                // $('#draggableDiv_' + 1).draggable({ disabled: false }).resizable({ disabled: false });
                $('#draggableDiv_In_' + 1 + '_1').draggable({ containment: "#page_" + PageNo, scroll: false, stop: function () { UpdateInCoordinates(this); } });
                $('#draggableDiv_In_' + 1 + '_1').resizable({
                    containment: "#page_" + PageNo, minHeight: 32,
                    maxHeight: 88,
                    minWidth: 34,
                    maxWidth: 99, stop: function () { UpdateInCoordinates(this); }
                });
            }
            else if (SelectedValue == "LAST") {
                $(".Initials").remove();
                $('#page_' + PageNo).append('<div id="draggableDiv_In_' + 1 + '_1" class="dragDiv Initials" style="left:' + Left + 'px; top:' + Top + 'px; height:' + Height + 'px; width:' + Width + 'px;"><span class="InImg">Initials</span></div>');
                //$('#draggableDiv_' + 1).draggable({ disabled: false }).resizable({ disabled: false });
                $('#draggableDiv_In_' + 1 + '_1').draggable({ containment: "#page_" + PageNo, scroll: false, stop: function () { UpdateInCoordinates(this); } });
                $('#draggableDiv_In_' + 1 + '_1').resizable({
                    containment: "#page_" + PageNo, minHeight: 32,
                    maxHeight: 88,
                    minWidth: 34,
                    maxWidth: 99, stop: function () { UpdateInCoordinates(this); }
                });
            }
            else {
                PageNumberDetails = PageNo.split(',');
                $(".Initials").remove();
                for (i = 0; i < PageNumberDetails.length - 1; i++) {
                    $('#page_' + PageNumberDetails[i]).append('<div  id="draggableDiv_In_' + 1 + '_' + (i + 1) + '" class="dragDiv Initials" style="left:' + Left + 'px; top:' + Top + 'px; height:' + Height + 'px; width:' + Width + 'px;"><span class="InImg">Initials</span></div>');
                    // $('#draggableDiv_' + 1).draggable({ disabled: false }).resizable({ disabled: false });
                    $('#draggableDiv_In_' + 1 + '_' + (i + 1) + '').draggable({ containment: "#page_" + PageNumberDetails[i], scroll: false, stop: function () { UpdateInCoordinates(this); } });
                    $('#draggableDiv_In_' + 1 + '_' + (i + 1) + '').resizable({
                        containment: "#page_" + PageNumberDetails[i], minHeight: 32,
                        maxHeight: 88,
                        minWidth: 34,
                        maxWidth: 99, stop: function () { UpdateInCoordinates(this); }
                    });
                }
            }

            Top = $('.documentVisual img').height() - Top;
            Height = (Number(Top) - Number(Height));
            Width = (Number(Left) + Number(Width));

            Coordinates = Left + ',' + Top + ',' + Width + ',' + Height;
            updIncCord = "true";
            $("#hdnInitialsCoordinates").val(Coordinates);
            //customselectPage = "true";
        }
        $(".Initials").draggable({ disabled: false }).resizable({ disabled: false });
    }


    var InitialsVisualizationId = parseInt($("#hdnInitialsImageOption").val());
    var InitialImage = $("#InitialsImage").val();
    if (InitialImage != "" && InitialImage != undefined) {
        var initialimagedata = "";
        if (InitialsVisualizationId == 1) {
            initialimagedata = '<img style="box-shadow: none !important;height: 100%;" src="' + InitialImage + '">';
        }
        else {
            initialimagedata = '<img style="width: inherit;box-shadow: none !important;height: 100%;" src="' + InitialImage + '">';
        }
        $(".Initials img").remove();
        $(".Initials span").html('');
        $(".Initials").append(initialimagedata);
        $(".dragDiv.Initials").addClass("focused");
    }

    $(".delSigner").on("click", function () {
        var Id = $(this).attr('id');
        var SignerLength = 2;
        var Final_Li_Length = SignerLength - 1;
        if (Final_Li_Length == 1) {
            $('#btnmsgok').removeAttr('onClick');
            $("#btnmsgcancel").hide();
            $("#msgcontent").attr("class", "info");
            $('#msgcontent').html("Atleast one signatory is required to Sign a document.");
            $(".alertWindow").css({ 'display': "block" });
            $('#btnmsgok').attr('onclick', "");
            $('#btnmsgok').attr("href", "javascript:Returncontrol('Y','');");
            return false;
        }
    });

    if (ValidateAllPlaceholders == "True") {
        GetAllPlaceholdersID();
    }
});

$('#ddlInitialsPosition').change(function () {
    var SelectedValue = $('#ddlInitialsPosition option:selected').val();
    var DocID = $("#hdnDocumentNumber").val();
    var PageValue = $('#ddlInitialsPageSelection option:selected').val();
    var imagewidth = parseInt($('.documentVisual img').width());
    if (SelectedValue == "CUSTOMIZE") {
        var PageNumberDetails = Array();
        var pageCount = $('.documentVisual').length;
        var pageCount = $("#hdnNoOfPages").val();
        if (PageValue == "FIRST") {
            PageNumberDetails.push(1);
        }
        else if (PageValue == "ALL") {
            for (i = 0; i < pageCount; i++) {
                PageNumberDetails.push((i + 1));
            }
        }
        else if (PageValue == "EVEN") {
            for (i = 0; i < pageCount; i++) {
                if (((i + 1) % 2) == 0) {
                    PageNumberDetails.push((i + 1));
                }
            }
        }
        else if (PageValue == "ODD") {
            for (i = 0; i < pageCount; i++) {
                if (((i + 1) % 2) != 0) {
                    PageNumberDetails.push((i + 1));
                }
            }
        }
        else if (PageValue == "LAST") {
            PageNumberDetails.push(pageCount);
        }
        else {
            var CSVPageNumbers = $("#txtInitialsPageNumbers").val().split(',');
            for (m = 0; m < CSVPageNumbers.length; m++) {
                PageNumberDetails.push(CSVPageNumbers[m]);
            }
        }
        $("#divCoordinates").show();
        var id = $('#draggableDiv_In_' + 1 + '_' + 1)[0];
        var Width = parseInt(id.offsetWidth);
        var Height = parseInt(id.offsetHeight);
        var Left = id.offsetLeft;
        var Top = id.offsetTop;
        $("#txtLeft").val(Left);
        $("#txtTop").val(TopDetails);
        $("#txtHeight").val(Height);
        $("#txtWidth").val(Width);
        $(".Initials").remove();
        if (PageValue == "FIRST") {
            $(".Initials").remove();
            $('#page_' + PageNumberDetails[0]).append('<div id="draggableDiv_In_' + 1 + '_1" class="dragDiv Initials" style="left:' + Left + 'px; top:' + Top + 'px; height:' + Height + 'px; width:' + Width + 'px;"><span class="InImg">Initials</span></div>');
            $('#draggableDiv_In_' + 1 + '_1').draggable({ containment: "#page_" + PageNumberDetails[0], scroll: false, stop: function () { UpdateInCoordinates(this); } });
            $('#draggableDiv_In_' + 1 + '_1').resizable({
                containment: "#page_" + PageNumberDetails[0], minHeight: 32,
                maxHeight: 88,
                minWidth: 34,
                maxWidth: 99, stop: function () { UpdateInCoordinates(this); }
            });
        }
        else if (PageValue == "LAST") {
            $(".Initials").remove();
            $('#page_' + PageNumberDetails[0]).append('<div id="draggableDiv_In_' + 1 + '_1" class="dragDiv Initials" style="left:' + Left + 'px; top:' + Top + 'px; height:' + Height + 'px; width:' + Width + 'px;"><span class="InImg">Initials</span></div>');
            $('#draggableDiv_In_' + 1 + '_1').draggable({ containment: "#page_" + PageNumberDetails[0], scroll: false, stop: function () { UpdateInCoordinates(this); } });
            $('#draggableDiv_In_' + 1 + '_1').resizable({
                containment: "#page_" + PageNumberDetails[0], minHeight: 32,
                maxHeight: 88,
                minWidth: 34,
                maxWidth: 99, stop: function () { UpdateInCoordinates(this); }
            });
        }
        else {
            $(".Initials").remove();
            for (i = 0; i < PageNumberDetails.length; i++) {
                $('#page_' + PageNumberDetails[i]).append('<div id="draggableDiv_In_' + 1 + '_' + (i + 1) + '" class="dragDiv Initials" style="left:' + Left + 'px; top:' + Top + 'px; height:' + Height + 'px; width:' + Width + 'px;"><span class="InImg">Initials</span></div>');
                $('#draggableDiv_In_' + 1 + '_' + (i + 1) + '').draggable({ containment: "#page_" + PageNumberDetails[i], disabled: false, scroll: false, stop: function () { UpdateInCoordinates(this); } });
                $('#draggableDiv_In_' + 1 + '_' + (i + 1) + '').resizable({
                    containment: "#page_" + PageNumberDetails[i], minHeight: 32,
                    maxHeight: 88,
                    minWidth: 34,
                    maxWidth: 99, disabled: false, scroll: false, stop: function () { UpdateInCoordinates(this); }
                });
            }
        }
        $('.Initials').draggable({ disabled: false }).resizable({ disabled: false });

        Top = $('.documentVisual img').height() - Top;
        Height = (Number(Top) - Number(Height));
        Width = (Number(Left) + Number(Width));

        Coordinates = Left + ',' + Top + ',' + Width + ',' + Height;
        updIncCord = "true";
        $("#hdnInitialsCoordinates").val(Coordinates);
        //customselectPage = "true";
    }
    else {
        var PageNumberDetails = Array();
        var pageCount = $('.documentVisual').length;
        var pageCount = $("#hdnNoOfPages").val();
        if (PageValue == "FIRST") {
            PageNumberDetails.push(1);
        }
        else if (PageValue == "ALL") {
            for (i = 0; i < pageCount; i++) {
                PageNumberDetails.push((i + 1));
            }
        }
        else if (PageValue == "EVEN") {
            for (i = 0; i < pageCount; i++) {
                if (((i + 1) % 2) == 0) {
                    PageNumberDetails.push((i + 1));
                }
            }
        }
        else if (PageValue == "ODD") {
            for (i = 0; i < pageCount; i++) {
                if (((i + 1) % 2) != 0) {
                    PageNumberDetails.push((i + 1));
                }
            }
        }
        else if (PageValue == "LAST") {
            PageNumberDetails.push(pageCount);
        }
        else {
            var CSVPageNumbers = $("#txtInitialsPageNumbers").val().split(',');
            for (m = 0; m < CSVPageNumbers.length; m++) {
                PageNumberDetails.push(CSVPageNumbers[m]);
            }
        }
        var Left, Top, Height = 32, Width = 34;

        //if (SelectedValue == "Top-Left") {
        //    Left = 7; TopDetails = docType == "Portrait" ? 839 : 590; Height = 32; Width = 32;
        //    Top = prHeight - TopDetails;
        //}
        //else if (SelectedValue == "Top-Center") {
        //    Left = docType == "Portrait" ? 244 : 380; TopDetails = docType == "Portrait" ? 839 : 590; Height = 32; Width = 34;
        //    Top = prHeight - TopDetails;
        //}
        //else if (SelectedValue == "Top-Right") {
        //    Left = (imagewidth - (Width + 1)); TopDetails = docType == "Portrait" ? 839 : 590;
        //    Top = prHeight - TopDetails;
        //}
        //else if (SelectedValue == "Middle-Left") {
        //    Left = 7; TopDetails = docType == "Portrait" ? 485 : 359; Height = 32; Width = 34;
        //    Top = prHeight - TopDetails;
        //}
        //else if (SelectedValue == "Middle-Center") {
        //    Left = docType == "Portrait" ? 243 : 361; TopDetails = docType == "Portrait" ? 484 : 331; Height = 32; Width = 34;
        //    Top = prHeight - TopDetails;
        //}
        //else if (SelectedValue == "Middle-Right") {
        //    Left = (imagewidth - (Width + 1)); TopDetails = docType == "Portrait" ? 483 : 348; Height = 32; Width = 34;
        //    Top = prHeight - TopDetails;
        //}
        //else if (SelectedValue == "Bottom-Left") {
        //    Left = 7; TopDetails = 65; Height = 32; Width = 34;
        //    Top = prHeight - TopDetails;
        //}
        //else if (SelectedValue == "Bottom-Center") {
        //    Left = docType == "Portrait" ? 248 : 361; TopDetails = docType == "Portrait" ? 65 : 71; Height = 32; Width = 34;
        //    Top = prHeight - TopDetails;
        //}
        //else if (SelectedValue == "Bottom-Right") {
        //    Left = (imagewidth - (Width + 1)); TopDetails = docType == "Portrait" ? 66 : 68;
        //    Top = prHeight - TopDetails;
        //}

        $('#divCoordinates').hide();
        prHeight = $('.documentVisual img').height();
        var actualPageHeight = $('.documentVisual img')[0].offsetHeight;
        Height = 32; Width = 34;
        if (SelectedValue == "Top-Left") {
            $('#txtLeft').attr('disabled', true);
            Left = defaultLeftPxValue; TopDetails = actualPageHeight - defaultTopPxValue;
            Top = prHeight - TopDetails;
            var top1 = $('.documentVisual img').height()
            Top = prHeight - TopDetails;

        }
        else if (SelectedValue == "Top-Center") {
            Left = ((($('.documentVisual img')[0].offsetWidth / 2) - (defaultInWidthPxValue / 2)) + defaultLeftPxValue) + $('.documentVisual img')[0].offsetLeft;
            TopDetails = actualPageHeight - defaultTopPxValue;
            Top = prHeight - TopDetails;

        }
        else if (SelectedValue == "Top-Right") {
            Left = (($('.documentVisual img')[0].offsetWidth - defaultInWidthPxValue) - defaultLeftPxValue) - $('.documentVisual img')[0].offsetLeft;
            TopDetails = actualPageHeight - defaultTopPxValue;
            Top = prHeight - TopDetails;
        }
        else if (SelectedValue == "Middle-Left") {
            Left = defaultLeftPxValue; TopDetails = (Number(prHeight) + defaultInHeightPxValue) / 2;
            Top = prHeight - TopDetails;
        }
        else if (SelectedValue == "Middle-Center") {
            Left = ((($('.documentVisual img')[0].offsetWidth / 2) - (defaultInWidthPxValue / 2)) + defaultLeftPxValue) + $('.documentVisual img')[0].offsetLeft;
            TopDetails = (Number(prHeight) + defaultInHeightPxValue) / 2;
            Top = $('.documentVisual img').height() - TopDetails;
        }
        else if (SelectedValue == "Middle-Right") {
            Left = (($('.documentVisual img')[0].offsetWidth - defaultInWidthPxValue) - defaultLeftPxValue) - $('.documentVisual img')[0].offsetLeft;
            TopDetails = (Number(prHeight) + defaultInHeightPxValue) / 2;
            Top = $('.documentVisual img').height() - TopDetails;
        }
        else if (SelectedValue == "Bottom-Left") {
            Left = defaultLeftPxValue;
            TopDetails = defaultInHeightPxValue + defaultBottomPxValue;
            Top = $('.documentVisual img').height() - TopDetails;
        }
        else if (SelectedValue == "Bottom-Center") {
            Left = ((($('.documentVisual img')[0].offsetWidth / 2) - (defaultInWidthPxValue / 2)) + defaultLeftPxValue) + $('.documentVisual img')[0].offsetLeft;
            TopDetails = defaultInHeightPxValue + defaultBottomPxValue;
            Top = prHeight - TopDetails;
        }
        else if (SelectedValue == "Bottom-Right") {
            Left = (($('.documentVisual img')[0].offsetWidth - defaultInWidthPxValue) - defaultLeftPxValue) - $('.documentVisual img')[0].offsetLeft;
            TopDetails = defaultInHeightPxValue + defaultBottomPxValue;
            Top = prHeight - TopDetails;
        }

        $(".Initials").remove();
        if (PageValue == "FIRST") {
            $(".Initials").remove();
            $('#page_' + PageNumberDetails[0]).append('<div id="draggableDiv_In_1' + '_' + 1 + '" class="dragDiv Initials" style="left:' + Left + 'px; top:' + Top + 'px; height:' + Height + 'px; width:' + Width + 'px;"><span class="InImg">Initials</span></div>');
            $('#draggableDiv_In_' + 1 + '_1').draggable({ containment: "#page_" + PageNumberDetails[0], scroll: false, stop: function () { UpdateInCoordinates(this); } });
            $('#draggableDiv_In_' + 1 + '_1').resizable({
                containment: "#page_" + PageNumberDetails[0], minHeight: 32,
                maxHeight: 88,
                minWidth: 34,
                maxWidth: 99, stop: function () { UpdateInCoordinates(this); }
            });
        }
        else if (PageValue == "LAST") {
            $(".Initials").remove();
            $('#page_' + PageNumberDetails[0]).append('<div id="draggableDiv_In_' + 1 + '_1" class="dragDiv Initials" style="left:' + Left + 'px; top:' + Top + 'px; height:' + Height + 'px; width:' + Width + 'px;"><span class="InImg">Initials</span></div>');
            $('#draggableDiv_In_' + 1 + '_1').draggable({ containment: "#page_" + PageNumberDetails[0], scroll: false, stop: function () { UpdateInCoordinates(this); } });
            $('#draggableDiv_In_' + 1 + '_1').resizable({
                containment: "#page_" + PageNumberDetails[0], minHeight: 32,
                maxHeight: 88,
                minWidth: 34,
                maxWidth: 99, stop: function () { UpdateInCoordinates(this); }
            });
        }
        else {
            $(".Initials").remove();
            for (i = 0; i < PageNumberDetails.length; i++) {
                $('#page_' + PageNumberDetails[i]).append('<div id="draggableDiv_In_' + 1 + '_' + (i + 1) + '" class="dragDiv Initials" style="left:' + Left + 'px; top:' + Top + 'px; height:' + Height + 'px; width:' + Width + 'px;"><span class="InImg">Initials</span></div>');
                $('#draggableDiv_In_' + 1 + '_' + (i + 1) + '').draggable({ containment: "#page_" + PageNumberDetails[i], disabled: false, scroll: false, stop: function () { UpdateInCoordinates(this); } });
                $('#draggableDiv_In_' + 1 + '_' + (i + 1) + '').resizable({
                    containment: "#page_" + PageNumberDetails[i], minHeight: 32,
                    maxHeight: 88,
                    minWidth: 34,
                    maxWidth: 99, disabled: false, scroll: false, stop: function () { UpdateInCoordinates(this); }
                });
            }
        }
        $('Initials').draggable({ disabled: false }).resizable({ disabled: false });
        Top = $('.documentVisual img').height() - Top;
        Height = (Number(Top) - Number(Height));
        Width = (Number(Left) + Number(Width));

        Coordinates = Left + ',' + Top + ',' + Width + ',' + Height;
        updIncCord = "true";
        $("#hdnInitialsCoordinates").val(Coordinates);
        customselectPage = "true";
    }
    $(".delSigner").on("click", function () {
        var Id = $(this).attr('id');
        var SignerLength = 2;
        var Final_Li_Length = SignerLength - 1;
        if (Final_Li_Length == 1) {
            $('#btnmsgok').removeAttr('onClick');
            $("#btnmsgcancel").hide();
            $("#msgcontent").attr("class", "info");
            $('#msgcontent').html("Atleast one signatory is required to Sign a document.");
            $(".alertWindow").css({ 'display': "block" });
            $('#btnmsgok').attr('onclick', "");
            $('#btnmsgok').attr("href", "javascript:Returncontrol('Y','');");
            return false;
        }
    });


    var InitialsVisualizationId = parseInt($("#hdnInitialsImageOption").val());
    var InitialImage = $("#InitialsImage").val();
    if (InitialImage != "" && InitialImage != undefined) {
        var initialimagedata = "";
        if (InitialsVisualizationId == 1) {
            initialimagedata = '<img style="box-shadow: none !important;height: 100%;" src="' + InitialImage + '">';
        }
        else {
            initialimagedata = '<img style="width: inherit;box-shadow: none !important;height: 100%;" src="' + InitialImage + '">';
        }
        $(".Initials img").remove();
        $(".Initials span").html('');
        $(".Initials").append(initialimagedata);
        $(".dragDiv.Initials").addClass("focused");
    }
    if (ValidateAllPlaceholders == "True") {
        GetAllPlaceholdersID();
    }
});

$("#btnInitialsApply").on("click", function () {
    Specifyval = 1;
    var imagewidth = parseInt($('.documentVisual img').width());
    if ($('#txtInitialsPageNumbers').val() == "") {
        $("#btnmsgcancel").hide();
        $("#msgcontent").attr("class", "info");
        $('#msgcontent').html("Enter Pageno");
        $(".alertWindow").css({ 'display': "block" });
        $('#btnmsgok').attr("href", "javascript:Returncontrol('Y','');");
        return false;
    }
    var Noofpages = $('.documentVisual').length;
    var csvPageNumbers = $('#txtInitialsPageNumbers').val().split(',');
    $("#InitialsPageNumbers").val(csvPageNumbers);
    for (i = 0; i < csvPageNumbers.length; i++) {
        if (csvPageNumbers[i] != "") {
            if (csvPageNumbers[i] > Noofpages) {
                $("#btnmsgcancel").hide();
                $("#msgcontent").attr("class", "info");
                $('#msgcontent').html("Enter valid page no");
                $(".alertWindow").css({ 'display': "block" });
                $('#btnmsgok').attr("href", "javascript:Returncontrol('Y','');");
                return false;
            }
        }
    }
    var selectedSignaturePosition = $('#ddlInitialsPosition option:selected').val();
    var PageNo = $('#ddlInitialsPageSelection option:selected').val();
    var Width, Height, Left, top, Top;
    if (selectedSignaturePosition == "CUSTOMIZE") {
        $('#txtRight, #txtHeight, #txtWidth, #txtLeft').attr('disabled', true);
        var pageNumbers = $('#txtInitialsPageNumbers').val().split(',');
        if (PageNo != "PAGE LEVEL") {
            if ($(".dragDiv").length > 0) {
                Left = 7; TopDetails = docType == "Portrait" ? 839 : 593; Height = 32; Width = 34;
                Top = $('.documentVisual img').height() - TopDetails;

                var id = $('#draggableDiv_In_' + 1 + '_' + 1)[0];
                var Width = parseInt(id.offsetWidth);
                var Height = parseInt(id.offsetHeight);
                var Left = id.offsetLeft;
                var Top = id.offsetTop;
                $(".Initials").remove();
                for (i = 0; i < csvPageNumbers.length; i++) {
                    $('#page_' + csvPageNumbers[i]).append('<div id="draggableDiv_In_' + 1 + '_' + (i + 1) + '" class="dragDiv Initials" style="left:' + Left + 'px; top:' + Top + 'px; height:' + Height + 'px; width:' + Width + 'px;"><span class="InImg">Initials</span></div>');
                    $('#draggableDiv_In_' + 1 + '_' + (i + 1) + '').draggable({ containment: "#page_" + csvPageNumbers[i], disabled: false, scroll: false, stop: function () { UpdateInCoordinates(this); } });
                    $('#draggableDiv_In_' + 1 + '_' + (i + 1) + '').resizable({
                        containment: "#page_" + csvPageNumbers[i], minHeight: 32,
                        maxHeight: 88,
                        minWidth: 34,
                        maxWidth: 99, disabled: false, scroll: false, stop: function () { UpdateInCoordinates(this); }
                    });
                }
            }
            else {
                Left = defaultLeftPxValue; TopDetails = $('.documentVisual img').height() - defaultTopPxValue; Height = 32; Width = 34;
                Top = $('.documentVisual img').height() - TopDetails;
                for (i = 0; i < pageNumbers.length; i++) {
                    $('#page_' + csvPageNumbers[i]).append('<div id="draggableDiv_In_' + 1 + '_' + (i + 1) + '" class="dragDiv Initials" style="left:' + Left + 'px; top:' + Top + 'px; height:' + Height + 'px; width:' + Width + 'px;"><span class="InImg">Initials</span></div>');
                    $('#draggableDiv_In_' + 1 + '_' + (i + 1) + '').draggable({ containment: "#page_" + csvPageNumbers[i], disabled: false, scroll: false, stop: function () { UpdateInCoordinates(this); } });
                    $('#draggableDiv_In_' + 1 + '_' + (i + 1) + '').resizable({
                        containment: "#page_" + csvPageNumbers[i], minHeight: 32,
                        maxHeight: 88,
                        minWidth: 34,
                        maxWidth: 99, disabled: false, scroll: false, stop: function () { UpdateInCoordinates(this); }
                    });
                }
            }

            Top = $('.documentVisual img').height() - Top;
            Height = (Number(Top) - Number(Height));
            Width = (Number(Left) + Number(Width));

            Coordinates = Left + ',' + Top + ',' + Width + ',' + Height;
            updIncCord = "true";
            $("#hdnInitialsCoordinates").val(Coordinates);
            //$("#ddlInitialsPosition").val("CUSTOMIZE");
            $("#InitialsPageNumbers").val(pageNumbers);
            customselectPage = "true";
        }
        else {
            $('.Initials').draggable({ containment: "#signerContainment", scroll: false, stop: function () { UpdateInCoordinates(this); } });
            $('.Initials').resizable({
                containment: "#page_1", minHeight: 32,
                maxHeight: 88,
                minWidth: 34,
                maxWidth: 99, stop: function () { UpdateInCoordinates(this); }
            });
        }

    }
    else {
        $(".Initials").remove();
        Height = 32; Width = 34;
        if (selectedSignaturePosition == "Top-Left") {
            Left = defaultLeftPxValue; TopDetails = actualPageHeight - defaultTopPxValue;
            Top = prHeight - TopDetails;
            $("#txtLeft").val(Left);
            $("#txtTop").val(TopDetails);
            $("#txtHeight").val(Height);
            $("#txtWidth").val(Width);
        }
        else if (selectedSignaturePosition == "Top-Center") {
            $(".Initials").remove();
            Left = ((($('.documentVisual img')[0].offsetWidth / 2) - (defaultInWidthPxValue / 2)) + defaultLeftPxValue) + $('.documentVisual img')[0].offsetLeft;
            TopDetails = actualPageHeight - defaultTopPxValue;
            Top = $('.documentVisual img').height() - TopDetails;
            $("#txtLeft").val(Left);
            $("#txtTop").val(TopDetails);
            $("#txtHeight").val(Height);
            $("#txtWidth").val(Width);
        }
        else if (selectedSignaturePosition == "Top-Right") {
            $(".Initials").remove();
            Left = (($('.documentVisual img')[0].offsetWidth - defaultInWidthPxValue) - defaultLeftPxValue) - $('.documentVisual img')[0].offsetLeft;
            TopDetails = actualPageHeight - defaultTopPxValue;
            Top = $('.documentVisual img').height() - TopDetails;
            $("#txtLeft").val(Left);
            $("#txtTop").val(TopDetails);
            $("#txtHeight").val(Height);
            $("#txtWidth").val(Width);
        }
        else if (selectedSignaturePosition == "Middle-Left") {
            $(".Initials").remove();
            Left = defaultLeftPxValue; TopDetails = (Number(prHeight) + defaultInHeightPxValue) / 2;
            Top = $('.documentVisual img').height() - TopDetails;
            $("#txtLeft").val(Left);
            $("#txtTop").val(TopDetails);
            $("#txtHeight").val(Height);
            $("#txtWidth").val(Width);
        }
        else if (selectedSignaturePosition == "Middle-Center") {
            $(".Initials").remove();
            Left = ((($('.documentVisual img')[0].offsetWidth / 2) - (defaultInWidthPxValue / 2)) + defaultLeftPxValue) + $('.documentVisual img')[0].offsetLeft;
            TopDetails = (Number(prHeight) + defaultInHeightPxValue) / 2;
            Top = $('.documentVisual img').height() - TopDetails;
            $("#txtLeft").val(Left);
            $("#txtTop").val(TopDetails);
            $("#txtHeight").val(Height);
            $("#txtWidth").val(Width);
        }
        else if (selectedSignaturePosition == "Middle-Right") {
            $(".Initials").remove();
            Left = (($('.documentVisual img')[0].offsetWidth - defaultInWidthPxValue) - defaultLeftPxValue) - $('.documentVisual img')[0].offsetLeft;
            TopDetails = (Number(prHeight) + defaultInHeightPxValue) / 2;
            Top = $('.documentVisual img').height() - TopDetails;
            $("#txtLeft").val(Left);
            $("#txtTop").val(TopDetails);
            $("#txtHeight").val(Height);
            $("#txtWidth").val(Width);
        }
        else if (selectedSignaturePosition == "Bottom-Left") {
            $(".Initials").remove();
            Left = defaultLeftPxValue;
            TopDetails = defaultInHeightPxValue + defaultBottomPxValue;
            Top = $('.documentVisual img').height() - TopDetails;
            $("#txtLeft").val(Left);
            $("#txtTop").val(TopDetails);
            $("#txtHeight").val(Height);
            $("#txtWidth").val(Width);
        }
        else if (selectedSignaturePosition == "Bottom-Center") {
            $(".Initials").remove();
            Left = ((($('.documentVisual img')[0].offsetWidth / 2) - (defaultInWidthPxValue / 2)) + defaultLeftPxValue) + $('.documentVisual img')[0].offsetLeft;
            TopDetails = defaultInHeightPxValue + defaultBottomPxValue;
            Top = $('.documentVisual img').height() - TopDetails;
            $("#txtLeft").val(Left);
            $("#txtTop").val(TopDetails);
            $("#txtHeight").val(Height);
            $("#txtWidth").val(Width);
        }
        else if (selectedSignaturePosition == "Bottom-Right") {
            $(".Initials").remove();
            Left = (($('.documentVisual img')[0].offsetWidth - defaultInWidthPxValue) - defaultLeftPxValue) - $('.documentVisual img')[0].offsetLeft;
            TopDetails = defaultInHeightPxValue + defaultBottomPxValue;
            Top = $('.documentVisual img').height() - TopDetails;
            $("#txtLeft").val(Left);
            $("#txtTop").val(TopDetails);
            $("#txtHeight").val(Height);
            $("#txtWidth").val(Width);
        }
        var pageNumbers = $('#txtInitialsPageNumbers').val().split(',');
        for (i = 0; i < pageNumbers.length; i++) {
            $('#page_' + pageNumbers[i]).append('<div id="draggableDiv_In_' + 1 + '_' + (i + 1) + '" class="dragDiv Initials" style="left:' + Left + 'px; top:' + Top + 'px; height:' + Height + 'px; width:' + Width + 'px;"><span class="InImg">Initials</span></div>');
            $('#draggableDiv_In_' + 1 + '_' + (i + 1) + '').draggable({ containment: "#page_" + csvPageNumbers[i], disabled: false, scroll: false, stop: function () { UpdateInCoordinates(this); } });
            $('#draggableDiv_In_' + 1 + '_' + (i + 1) + '').resizable({
                containment: "#page_" + csvPageNumbers[i], minHeight: 32,
                maxHeight: 88,
                minWidth: 34,
                maxWidth: 99, disabled: false, scroll: false, stop: function () { UpdateInCoordinates(this); }
            });
        }
        Top = $('.documentVisual img').height() - Top;
        Height = (Number(Top) - Number(Height));
        Width = (Number(Left) + Number(Width));

        Coordinates = Left + ',' + Top + ',' + Width + ',' + Height;
        updIncCord = "true";
        $("#hdnInitialsCoordinates").val(Coordinates);
        //$("#ddlInitialsPosition").val("CUSTOMIZE");
        $("#InitialsPageNumbers").val(pageNumbers);
        //customselectPage = "true";
    }

    var InitialsVisualizationId = parseInt($("#hdnInitialsImageOption").val());
    var InitialImage = $("#InitialsImage").val();
    if (InitialImage != "" && InitialImage != undefined) {
        var initialimagedata = "";
        if (InitialsVisualizationId == 1) {
            initialimagedata = '<img style="box-shadow: none !important;height: 100%;" src="' + InitialImage + '">';
        }
        else {
            initialimagedata = '<img style="width: inherit;box-shadow: none !important;height: 100%;" src="' + InitialImage + '">';
        }
        $(".Initials img").remove();
        $(".Initials span").html('');
        $(".Initials").append(initialimagedata);
        $(".dragDiv.Initials").addClass("focused");
    }
    if (ValidateAllPlaceholders == "True") {
        GetAllPlaceholdersID();
    }
});

function CreatePageLevelInitials() {

    var currentId = 1;
    //var Height = 32, Width = 34;
    var arr = $('.Initials').length;
    if (arr == 0) {
        var Top, Left, width, Height, id, sLeft, sTop;
        id = 1;
        Left = 0; Top = 0; Height = 32; Width = 34;
        if (arr == 0) {
            Left = 10; Top = 10; Height = 32; Width = 34;
        }
        for (i = 0, l = arr; i < l; i++) {
            if (Left > 450) {
                Left = Left;
                Top = Top;
            } else {
                Left = Left + 10;
                Top = Top + 10;
            }
            id = id + 1;
        }
        $('#page_1').append('<div id="draggableDiv_In_' + currentId + '_' + id + '" class="dragDiv Initials" style="left:' + Left + 'px; top:' + Top + 'px; width:' + Width + 'px; height:' + Height + 'px;"><span class="InImg">In</span><a href="javascript:void(0);" id="DeleteIn_' + currentId + '_' + id + '" class="delInPL" title="Delete"><span><i class="fa fa-remove"></i></span></a><p class="email"></p></div>'); //(I' + id + ')
        $('.Initials').draggable({ containment: "#signerContainment", scroll: false, stop: function () { UpdateInCoordinates(this); } });
        $('.Initials').resizable({
            containment: "#signerContainment", minHeight: 32,
            maxHeight: 88,
            minWidth: 34,
            maxWidth: 99, stop: function () { UpdateInCoordinates(this); }
        });
        //$('#InitialsPageLevels').append('<div class="PageLevelSignerNameRowPrep" id="PlistItem_' + id + '"><div class="prepContainer col1"><a class="searchsName" id="fieldlinkPage_' + id + '" href="javascript:void(0);"><span class="searchIco"></span></a>  </div><div class="prepContainer col2"><select class="pageSelValue valid" name="fieldInPagination_' + id + '" id="fieldInPagination_' + id + '" ></select></div><div class="prepContainer col3"><a class="actionButton" href="javascript:void(0);"><span class="delIInPL" id="DeleteIn_' + currentId + '_' + id + '"></span></a></div></div>');
        $('#InitialsPageLevels').append('<div class="PageLevelSignerNameRowPrep" id="PlistItemIn_' + id + '"><div class="prepContainer col1"><span class="signerName" id="InName_' + id + '"><span class="displaySigner displayIn">(In' + id + ')</span></span> </div><div class="prepContainer col2"><select class="pageSelValue1 valid" name="fieldInPagination_' + id + '" id="fieldInPagination_' + id + '" ></select></div><div class="prepContainer col3"><a class="actionButton" href="javascript:void(0);"><span class="delIInPL" id="DeleteInP_' + currentId + '_' + id + '"><i class="fa fa-remove"></i></span></a></div></div>');



        var p = $('.documentVisual').length;
        for (i = 1; i <= p; i++) {
            $("#fieldInPagination_" + id).append("<option value=" + i + ">" + i + "</option>");
        }
        var signatorylength = $(".Initials").length;
        var config = "";
        for (i = 1; i <= signatorylength; i++) {
            var Page = $('#fieldInPagination_' + i + ' option:selected').val();
            var id1 = $('#draggableDiv_In_' + currentId + '_' + i)[0];
            var Width = id1.offsetWidth;
            var Height = id1.offsetHeight;
            var Left = id1.offsetLeft;
            var Top = id1.offsetTop;
            Top = $('.documentVisual img').height() - Top;
            Height = (Number(Top) - Number(Height));
            Width = (Number(Left) + Number(Width));
            config += Page + ',' + Left + ',' + Top + ',' + Width + ',' + Height + ';';

            Coordinates = Page + ',' + Left + ',' + Top + ',' + Width + ',' + Height;
            updIncCord = "true";
            //customselectPage = "true";
        }
        config = config.substring(0, config.length - 1);
        var pageNumbers = config;
        $("#InitialsPagelevelCordinates").val(pageNumbers);
        $("#hdnInitialsCoordinates").val(pageNumbers);
        $('#draggableDiv_In_' + currentId + '_' + id + '').draggable({ disabled: false }).resizable({ disabled: false });

    }
    else {

        var Top, Left, width, Height, id, sLeft, sTop;
        id = 1;
        Left = 0; Top = 0; Height = 32; width = 34
        if (arr == 0) {
            Left = 10; Top = 10; Height = 32; width = 34;
        }
        for (i = 0, l = arr; i < l; i++) {
            if (Left > 450) {
                Left = Left;
                Top = Top;
            } else {
                Left = Left + 15;
                Top = Top + 15;
            }
            id = id + 1;
        }


        $('#page_1').append('<div id="draggableDiv_In_' + currentId + '_' + id + '" class="dragDiv Initials" style="left:' + Left + 'px; top:' + Top + 'px; height:' + Height + 'px; width:' + width + 'px;"><span class="InImg">In</span><a href="javascript:void(0);" id="DeleteIn_' + currentId + '_' + id + '" class="delInPL" title="Delete"><span><i class="fa fa-remove"></i></span></a><p class="email"></p></div>');//(I' + id + ')

        $('.Initials').draggable({ containment: "#signerContainment", scroll: false, stop: function () { UpdateInCoordinates(this); } });
        $('.Initials').resizable({
            containment: "#signerContainment", minHeight: 32,
            maxHeight: 88,
            minWidth: 34,
            maxWidth: 99, stop: function () { UpdateInCoordinates(this); }
        });
        //$('#InitialsPageLevels').append('<div class="PageLevelSignerNameRowPrep" id="PlistItem_' + id + '"><div class="prepContainer col1"><a class="searchsName" id="fieldlinkPage_' + id + '" href="javascript:void(0);"><span class="searchIco"></span></a>  </div><div class="prepContainer col2"><select class="pageSelValue valid" name="fieldInPagination_' + id + '" id="fieldInPagination_' + id + '" ></select></div><div class="prepContainer col3"><a class="actionButton" href="javascript:void(0);"><span class="delIInPL" id="DeleteIn_' + currentId + '_' + id + '"></span></a></div></div>');
        $('#InitialsPageLevels').append('<div class="PageLevelSignerNameRowPrep" id="PlistItemIn_' + id + '"><div class="prepContainer col1"><span class="signerName" id="InName_' + id + '"><span class="displaySigner displayIn">(In' + id + ')</span></span> </div><div class="prepContainer col2"><select class="pageSelValue1 valid" name="fieldInPagination_' + id + '" id="fieldInPagination_' + id + '" ></select></div><div class="prepContainer col3"><a class="actionButton" href="javascript:void(0);"><span class="delIInPL" id="DeleteInP_' + currentId + '_' + id + '"><i class="fa fa-remove"></i></span></a></div></div>');
        var p = $('.documentVisual').length;
        for (i = 1; i <= p; i++) {
            $("#fieldInPagination_" + id).append("<option value=" + i + ">" + i + "</option>");
        }
        var sL = $("#InitialsPageLevels .PageLevelSignerNameRowPrep").length;
        if (sL > 3) { $("#InitialsPageLevels").addClass("scrollSigner3Item"); } else { $("#InitialsPageLevels").removeClass("scrollSigner3Item"); }
        var signatorylength = $(".Initials").length;
        var config = "";
        for (i = 1; i <= signatorylength; i++) {
            var Page = $('#fieldInPagination_' + i + ' option:selected').val();
            var id1 = $('#draggableDiv_In_' + currentId + '_' + i)[0];
            var Width = id1.offsetWidth;
            var Height = id1.offsetHeight;
            var Left = id1.offsetLeft;
            var Top = id1.offsetTop;
            Top = $('.documentVisual img').height() - Top;
            Height = (Number(Top) - Number(Height));
            Width = (Number(Left) + Number(Width));
            config += Page + ',' + Left + ',' + Top + ',' + Width + ',' + Height + ';';



            Coordinates = Page + ',' + Left + ',' + Top + ',' + Width + ',' + Height;
            updIncCord = "true";
            //customselectPage = "true";
        }

        config = config.substring(0, config.length - 1);
        var pageNumbers = config;
        $("#InitialsPagelevelCordinates").val(pageNumbers);
        $("#hdnInitialsCoordinates").val(pageNumbers);
        $('#draggableDiv_In' + currentId + '_' + id + '').draggable({ disabled: false }).resizable({ disabled: false });
    }

    $(".documentVisual").each(function () {
        var n = $(this).attr("id"),
            t = n.split("_")[1].toString();
        $(this).droppable({
            accept: ".dragDiv",
            drop: function (n, t) {
                var a, v, r, i, o;
                if ((i = $(this).attr("id").split("_")[1], r != i)) {
                    var w = t.draggable.html(),
                        e = "#" + t.draggable.attr("id"),
                        s = $("#page_" + i).offset().left,
                        y = $("#page_" + i).offset().top,
                        p = $(e).offset().left,
                        h = $(e).offset().top,
                        c = parseInt(p) - parseInt(s),
                        l = parseInt(h) - parseInt(y);
                    $(e).appendTo($("#page_" + i)),
                        $(e).css("left", c + "px"), $(e).css("top", l + "px"),
                        o = t.draggable.attr("id").split("_")[2],
                        $("#fieldInPagination_" + o).val(i);
                }
            }
        });
        if (ValidateAllPlaceholders == "True") {
            GetAllPlaceholdersID();
        }
    })

    $('body').on('change', '.pageSelValue1', function () {
        var currentid = 1;
        var r = $(this).attr("id"),
            t = $(this).val(),
            n = r.split("_")[1],
            i = "#page_" + t;
        $("#draggableDiv_In_" + n).appendTo($(i));
        $("#draggableDiv_In_" + currentid + '_' + n).appendTo($(i));
        f = $(i).offset().top + $("#documentViewContent").scrollTop() - 120;
        $("#documentViewContent").animate({
            scrollTop: f
        }, "slow")
        if (typeof (n) != "undefined") {
            var arr = Array();
            $('.SignerNameRowPrep').each(function () {
                arr.push($(this).attr('id').replace('listItem_', ''));
            });

        }
        if (ValidateAllPlaceholders == "True") {
            GetAllPlaceholdersID();
        }
    });

    var InitialsVisualizationId = parseInt($("#hdnInitialsImageOption").val());
    var InitialImage = $("#InitialsImage").val();
    if (InitialImage != "" && InitialImage != undefined) {
        var initialimagedata = "";
        if (InitialsVisualizationId == 1) {
            initialimagedata = '<img style="box-shadow: none !important;height: 100%;" src="' + InitialImage + '">';
        }
        else {
            initialimagedata = '<img style="width: inherit;box-shadow: none !important;height: 100%;" src="' + InitialImage + '">';
        }
        $(".Initials img").remove();
        $(".Initials span").html('');
        $(".Initials").append(initialimagedata);
        $(".dragDiv.Initials").addClass("focused");
    }
    if (ValidateAllPlaceholders == "True") {
        GetAllPlaceholdersID();
    }
}

$('body').on("click", ".delInPL, .delIInPL", function () {

    var id = $(this).attr('id');
    var currentId = 1;
    var arr = [];
    $('.Initials').each(function (index, elem) {
        arr.push($(this).attr('id'));
    });
    var Id = $(this).attr('id');
    var DivId = Id.split('_')[2];
    $("#msgcontent").attr("class", "info");
    $('#msgcontent').html("Do you really want to delete?");
    $("#btnmsgcancel").show();
    $("#btnmsgcancel").attr('onclick', "javascript:Returncontrol('Y','');");
    $(".alertWindow").css({ 'display': "block" });
    $('#btnmsgok').attr('href', "javascript:DeletePageLevelIn(" + DivId + ");");

    var sL = $("#InitialsPageLevels .PageLevelSignerNameRowPrep").length;
    if (sL > 3) { $("#InitialsPageLevels").addClass("scrollSigner3Item"); } else { $("#InitialsPageLevels").removeClass("scrollSigner3Item"); }

    if (ValidateAllPlaceholders == "True") {
        GetAllPlaceholdersID();
    }

    return false;
});
function DeletePageLevelIn(DivId) {

    var currentId = 1;
    $('#draggableDiv_In_' + currentId + '_' + DivId).remove();
    $('#PlistItemIn_' + DivId).remove();
    var Ids = Array();
    $('.Initials').each(function () {
        Ids.push($(this).attr('id').replace('draggableDiv_In_', ''));
    });
    for (i = 0; i < Ids.length; i++) {
        $("#PlistItemIn_" + Ids[i].split('_')[1]).attr('id', 'PlistItemIn_' + (i + 1));
        $("#signerName_" + Ids[i].split('_')[1]).attr('id', 'signerName_' + (i + 1));
        if ($('#PagelevelName').val() != "") {
            //$("#PlistItem_" + (i + 1) + " .displaySigner").text($('#PagelevelName').val() + '(S' + (i + 1) + ')');
            $("#PlistItemIn_" + (i + 1) + " .displaySigner").text('(In' + (i + 1) + ')');
        }
        else {
            $("#PlistItemIn_" + (i + 1) + " .displaySigner").text('(In' + (i + 1) + ')');
        }
        $("#PlistItemIn_" + (i + 1) + " .delImgPL").attr('id', 'DeleteIn_' + currentId + '_' + (i + 1));
        $("#fieldlinkPage_" + Ids[i].split('_')[1]).attr('id', 'fieldlinkPage_' + (i + 1));
        $("#fieldInPagination_" + Ids[i].split('_')[1]).attr('id', 'fieldInPagination_' + (i + 1));
        $("#fieldInPagination_" + (i + 1)).attr('name', 'fieldInPagination_' + (i + 1));
        $("#draggableDiv_In_" + Ids[i]).attr('id', 'draggableDiv_In_' + currentId + '_' + (i + 1));
        $("#draggableDiv_In_" + currentId + '_' + (i + 1) + " .delInPL").attr('id', 'DeleteIn_' + currentId + '_' + (i + 1));
        //$("#draggableDiv_In_" + currentId + '_' + (i + 1) + " c
        $("#draggableDiv_In_" + currentId + '_' + (i + 1) + " .number").text(currentId);
        //$("#draggableDiv_" + currentId + '_' + (i + 1) + " .email").text("Signatory " + currentId + '(S' + (i + 1) + ')');
        $("#draggableDiv_In_" + currentId + '_' + (i + 1) + " .email").text('');
        $("#PlistItemIn_" + (i + 1) + " .delIInPL").attr('id', 'DeleteInP_' + currentId + '_' + (i + 1));
    }
    $(".alertWindow").hide();
    var sL = $("#InitialsPageLevels .PageLevelSignerNameRowPrep").length;
    if (sL > 3) { $("#InitialsPageLevels").addClass("scrollSigner3Item"); } else { $("#InitialsPageLevels").removeClass("scrollSigner3Item"); }
    var DocID = $("#hdnDocumentNumber").val();
    var Value = $("#hdnSavedConfig_" + DocID).val();
    if (Value != "") {
        var signatorylength = $(".Initials").length;
        var config = "";
        for (i = 1; i <= signatorylength; i++) {
            var Page = $('#fieldInPagination_' + i + ' option:selected').val();
            var id = $('#draggableDiv_In_' + currentId + '_' + i)[0];
            var Width = id.offsetWidth;
            var Height = id.offsetHeight;
            var Left = id.offsetLeft;
            var Top = id.offsetTop;
            Top = $('.documentVisual img').height() - Top;
            Height = (Number(Top) - Number(Height));
            Width = (Number(Left) + Number(Width));
            config += Page + ',' + Left + ',' + Top + ',' + Width + ',' + Height + ';';
        }
        config = config.substring(0, config.length - 1);
        var PageLevelValue = config;
        var FinalValue = "-1_0_empty_All_CUSTOMIZE_" + PageLevelValue + "_ _ _ _ _PAGE LEVEL_1_1";
        $("#hdnconfig_" + DocID + "_" + currentId + "").val(FinalValue);
        var count = $(".configdetails" + DocID + "").length;

        updIncCord = "true";
        customselectPage = "true";
        $("#InitialsPagelevelCordinates").val(PageLevelValue);
        $("#hdnInitialsCoordinates").val(PageLevelValue);
    }
    var i = 1;
    $('.displayIn').each(function () {
        $(this).text('(In' + i + ')');
        i++;
    });
    if (ValidateAllPlaceholders == "True") {
        GetAllPlaceholdersID();
    }
}
function UpdateInCustomCoordinates(pageCount, docType) {

    var Left, Top, Height, Width;
    Left = defaultTopPxValue; TopDetails = $('.documentVisual img').height() - defaultTopPxValue; Height = 32; Width = 34;
    Top = prHeight - TopDetails;
    $('#page_1').append('<div id="draggableDiv_In_' + 1 + '_' + (0 + 1) + '" class="dragDiv Initials" style="left:' + Left + 'px; top:' + Top + 'px;height:' + Height + 'px; width:' + Width + 'px;"><span class="InImg">Initials</span></div>');
    $('#draggableDiv_In_' + 1 + '_' + (0 + 1)).draggable({ containment: "#page_1", scroll: false, stop: function () { UpdateInCoordinates(this); } });
    $('#draggableDiv_In_' + 1 + '_' + (0 + 1)).resizable({
        containment: "#page_1", minHeight: 32,
        maxHeight: 88,
        minWidth: 34,
        maxWidth: 99, stop: function () { UpdateInCoordinates(this); }
    });

    $('.Initials').draggable({ disabled: false }).resizable({ disabled: false });

    Top = $('.documentVisual img').height() - Top;
    Height = (Number(Top) - Number(Height));
    Width = (Number(Left) + Number(Width));

    Coordinates = Left + ',' + Top + ',' + Width + ',' + Height;
    updIncCord = "true";
    $("#hdnInitialsCoordinates").val(Coordinates);
    $("#ddlInitialsPosition").val("CUSTOMIZE");
    $("#ddlInitialsPageSelection").val("FIRST");
    //customselectPage = "true";

    if (ValidateAllPlaceholders == "True") {
        GetAllPlaceholdersID();
    }

}

$("#PLevelProfileIn").on("click", function () {
    CreatePageLevelInitials();
});
$("body").on('click', '.dragDiv.Initials', function () {

    if (!PouploadwdforInitials) { PoupInitialsLoadForInitials(); }

    if ((SelectedInitialsId == "" && $("#" + $(this).attr('id') + " img").length == 0) || $("#" + $(this).attr('id') + " img").length == 1) {

        var inl = $('#txtInitials').val() == "" ? DisplayName.substr(0, 2) : $('#txtInitials').val();
        $('.font-In').text(inl);
        $('#txtInitials').val(inl);
        $(this).attr("href", "#Initialsdropdown");
        $(this).attr("data-toggle", "modal");
        var id = $(".innertab-In-link.active").attr('id').split('_')[2];
        SelectedInitialsId = $(this).attr('id');
        $("#innertabContent_In_" + id).show();
    }
    else {
        var InitialsVisualizationId = parseInt($("#hdnInitialsImageOption").val());
        var InitialImage = $("#InitialsImage").val();
        if (InitialImage != "" && InitialImage != undefined) {
            var initialimagedata = "";
            if (InitialsVisualizationId == 1) {
                initialimagedata = '<img style="box-shadow: none !important;height: 100%;" src="' + InitialImage + '">';
            }
            else {
                initialimagedata = '<img style="width: inherit;box-shadow: none !important;height: 100%;" src="' + InitialImage + '">';
            }
            $("#" + $(this).attr('id') + " img").remove();
            $("#" + $(this).attr('id') + " span").html('');
            $("#" + $(this).attr('id')).append(initialimagedata);
            $("#" + $(this).attr('id')).addClass("focused");
        }
        else {
            var inl = $('#txtInitials').val() == "" ? DisplayName.substr(0, 2) : $('#txtInitials').val();
            $('.font-In').text(inl);
            $('#txtInitials').val(inl);
            $(this).attr("href", "#Initialsdropdown");
            $(this).attr("data-toggle", "modal");
            var id = $(".innertab-In-link.active").attr('id').split('_')[2];
            SelectedInitialsId = $(this).attr('id');
            $("#innertabContent_In_" + id).show();
        }
    }
});


$('body').on("click", "#btnApplyInitials", function () {

    var InitialsVisualizationId = parseInt($("#hdnInitialsImageOption").val());

    if (InitialsVisualizationId == 1 && $('#Initialsdropdown .sign-font-option li').hasClass('selected') == false) {
        ShowHidePleaseWait('N');
        $('#imgFollow').hide();
        $("#msgcontent").attr("class", "info");
        $('#msgcontent').html("Please select font for Initials");
        $("#btnmsgcancel").hide();
        $(".alertWindow").css({ 'display': "block" });
        $('#btnmsgok').attr('onclick', "javascript:Returncontrol('Y','');");
        return false;
    }
    else if (InitialsVisualizationId == 2 && ($('#divInitials').jSignature('getData') == "" || $('#divInitials').jSignature('getData').length == 0 || $('#divInitials').jSignature('getData').length == 6006 || $('#divInitials').jSignature('getData', 'native').length == 0)) {
        ShowHidePleaseWait('N');
        $('#imgFollow').hide();
        $("#msgcontent").attr("class", "info");
        $('#msgcontent').html("Please draw an Initials");
        $("#btnmsgcancel").hide();
        $(".alertWindow").css({ 'display': "block" });
        $('#btnmsgok').attr('onclick', "javascript:Returncontrol('Y','');");
        return false;
    }
    else if (InitialsVisualizationId == 3 && $("#txtInitialsimage").val().length == 0) {
        ShowHidePleaseWait('N');
        $('#imgFollow').hide();
        $("#msgcontent").attr("class", "info");
        $('#msgcontent').html("Please upload an image Initials file");
        $("#btnmsgcancel").hide();
        $(".alertWindow").css({ 'display': "block" });
        $('#btnmsgok').attr('onclick', "javascript:Returncontrol('Y','');");
        return false;
    }

    if ($("#InitialsImage").val().length == 0) {
        if (InitialsVisualizationId == 1) {
            ShowHidePleaseWait('N');
            $('#imgFollow').hide();
            $("#msgcontent").attr("class", "info");
            $('#msgcontent').html("Please select font for Initials");
            $("#btnmsgcancel").hide();
            $(".alertWindow").css({ 'display': "block" });
            $('#btnmsgok').attr('onclick', "javascript:Returncontrol('Y','');");
            return false;
        }
        else if (InitialsVisualizationId == 2 && ($('#divInitials').jSignature('getData') == "" || $('#divInitials').jSignature('getData').length == 0 || $('#divInitials').jSignature('getData').length == 6006 || $('#divInitials').jSignature('getData', 'native').length == 0)) {
            ShowHidePleaseWait('N');
            $('#imgFollow').hide();
            $("#msgcontent").attr("class", "info");
            $('#msgcontent').html("Please draw an Initials");
            $("#btnmsgcancel").hide();
            $(".alertWindow").css({ 'display': "block" });
            $('#btnmsgok').attr('onclick', "javascript:Returncontrol('Y','');");
            return false;
        }
        else if (InitialsVisualizationId == 3) {
            ShowHidePleaseWait('N');
            $('#imgFollow').hide();
            $("#msgcontent").attr("class", "info");
            $('#msgcontent').html("Please upload an image Initials file");
            $("#btnmsgcancel").hide();
            $(".alertWindow").css({ 'display': "block" });
            $('#btnmsgok').attr('onclick', "javascript:Returncontrol('Y','');");
            return false;
        }
    }

    if (InitialsVisualizationId == 2 && ($('#divInitials').jSignature('getData') == '' || $('#divInitials').jSignature('getData').length == 0 || $('#divInitials').jSignature('getData').length == 6006 || $('#divInitials').jSignature('getData', 'native').length == 0)) {
        ShowHidePleaseWait('N');
        $('#imgFollow').hide();
        $("#msgcontent").attr("class", "info");
        $('#msgcontent').html("Please draw an Initials");
        $("#btnmsgcancel").hide();
        $(".alertWindow").css({ 'display': "block" });
        $('#btnmsgok').attr('onclick', "javascript:Returncontrol('Y','');");
        return false;
    }

    if (InitialsVisualizationId == 2) {
        $("#InitialsImage").val($('#divInitials').jSignature('getData'));
    }
    $("#Initialsdropdown").modal('hide');
    $('.modal-backdrop').remove();
    var InitialImage = $("#InitialsImage").val();
    var initialimagedata = "";
    if (InitialsVisualizationId == 1) {
        initialimagedata = '<img style="box-shadow: none !important;height: 100%;" src="' + InitialImage + '">';
    }
    else {
        initialimagedata = '<img style="width: inherit;box-shadow: none !important;height: 100%;" src="' + InitialImage + '">';
    }
    $("#" + SelectedInitialsId + " img").remove();
    $("#" + SelectedInitialsId + " span").html('');
    $("#" + SelectedInitialsId).append(initialimagedata);
    $("#" + SelectedInitialsId).addClass("focused");
    $(".Initials").each(function () {
        if ($("#" + $(this).attr('id') + " img").length == 1) {
            $("#" + $(this).attr('id') + " img").remove();
            $("#" + $(this).attr('id') + " span").html('');
            $("#" + $(this).attr('id')).append(initialimagedata);
            $("#" + $(this).attr('id')).addClass("focused");
        }
    });
    return false;
});
$("body").on('click', ".dragDiv.Signatory1", function () {
    if ($("#ValidateAllPlaceholders").val() == "True") {
        if ($("#hdnPreviewesImageData").val() == "") {
            SelectedSignatureId = "";
        }
        if (SelectedSignatureId != "" && $('#' + $(this).attr('id') + ' .signImg:visible').length == 1) {
            var finaldata = "";
            var ImageData = "";
            var signedByHtmlTag = '<div class="signedby-tag" style="font-size: 8px;" id="p_signedby">Signed by [signedByName]</div>';
            signedByHtmlTag = signedByHtmlTag.replace("[signedByName]", $("#txtFullName").val() == "" ? DisplayName : $("#txtFullName").val());
            if ($("#ddlModeofSignature").val() == "3") {
                if (SignatureImg == "" || SignatureImg == null) {
                    if ($("#hdnSignatureImageOption").val() == 1) {
                        ImageData = $("#SignatureImage").val();
                        finaldata = $('#Signaturedropdown .imgdetails.selected .span-label').html();
                        $("#" + $(this).attr('id')).css("padding", "10px 0px");
                    }
                    else if ($("#hdnSignatureImageOption").val() == 2) {
                        if ($("#signature").jSignature('getData', 'native') != 0) {
                            ImageData = $('#signature').jSignature('getData');
                            $("#" + $(this).attr('id')).css('padding', '');
                            var pageWidth = $('.documentVisual img').width();
                            var screenDisplayWidth = $('#documentViewContent').width();
                            if (pageWidth > screenDisplayWidth) {
                                finaldata = "<img class='preview-company-stamp' style='width: 45% !important;' src='" + ImageData + "' />"
                            }
                            else {
                                finaldata = "<img class='preview-company-stamp' style='width: 100% !important;' src='" + ImageData + "' />"
                            }

                            //finaldata = "<img class='preview-company-stamp' style='width: 100% !important;' src='" + ImageData + "' />"
                        }
                    }
                    else if ($("#hdnSignatureImageOption").val() == 3) {
                        ImageData = $("#hdnPreviewesImageData").val();
                        finaldata = "<img class='preview-company-stamp' style='width: 75%% !important;height: 75% !important;' src='" + ImageData + "' />"
                        $("#" + $(this).attr('id')).css('padding', '');
                    }
                    else if ($("#hdnSignatureImageOption").val() == 4) {
                        ImageData = $("#hdntopozImagevalue").val();
                        $('#hdnSignatureImagevisible').val(1);
                        finaldata = "<img class='preview-company-stamp' style='width: 100% !important;' src='" + ImageData + "' />"
                        $("#" + $(this).attr('id')).css('padding', '');
                    }
                } else {
                    ImageData = SignatureImg;
                    finaldata = "<img class='preview-company-stamp' style='width: 100% !important;' src='" + ImageData + "' />"
                    $("#" + $(this).attr('id')).css('padding', '');
                }
                $("#hdnPreviewesImageData").val(ImageData);
                $("#" + $(this).attr('id') + " .email").remove();
                $("#" + $(this).attr('id') + " .signImg").hide();
                $("#" + $(this).attr('id') + " .signerName").html('').css('display', '');
                $("#" + $(this).attr('id') + " .signerName").show().append(finaldata).append(signedByHtmlTag);
                $(this).addClass('focused');
            }
            else {
                appendData = '<img style="width: 35px;height: 100%;box-shadow: none !important;" src="\\Content\\eMDMSCSS\\img\\1476729873_Check.jpg">';
                $("#" + $(this).attr('id') + " .signImg").hide();
                $("#" + $(this).attr('id') + " .email").remove();
                $("#" + $(this).attr('id') + " .signerName").html('').css('display', 'flex');
                $("#" + $(this).attr('id') + " .signerName").show().append(appendData).append(signedByHtmlTag);
                $("#" + $(this).attr('id') + " .Signatory1").css('padding', '5px');
                $(this).addClass('focused');
            }
        }
        else {
            if (!Pouploadwd) { PoupInitialsLoad() }
            $("#btnSignaftervalidateall,#btnvalidatecancel").show();
            $("#btnSignaturePreview,#div-Signtypes").show();
            $("#Signaturedropdown").modal("show");
            SelectedSignatureId = $(this).attr('id');
            $("#hdnSignatureImageOption").val($('.innertab-link.active').attr('id').split('_')[1]);
        }
    }

    return false;
});

function PoupInitialsLoad() {

    Pouploadwd = true;
    $("#txtFullName").val(DisplayName);
    $(".font-sign").text(DisplayName);
    $('input[name="backimg"]').attr('checked', false);
    $("#Signaturedropdown .sign-font-option li").removeClass("selected");
    $("#txtsignatureimage").val('');
    $("#lblerrormessage").text("");
    $('#SignatureImage').val("");
    $('#hdnFilePath').val("");
    $("#hdnSignatureImageOption").val("");
    if ($("#SelectFontOption").val() == "False") {
        if ($("#DrawSignatureOption").val() == "True") {
            var CanvasLength = $("#signature canvas").length;
            $("#innertabLink_2").addClass('active');
            $("#innertabContent_2").show();
            $("#innertabLink_1").removeClass('active');
            $("#innertabLink_3").removeClass('active');
            $("#innertabLink_4").removeClass('active');
            $("#innertabContent_1").hide();
            $("#innertabContent_3").hide();
            $("#innertabContent_4").hide();
            $("#hdnSignatureImageOption").val(2);
            //$("#signature").empty();
            if (CanvasLength == 0) {
                $("#signature").jSignature({
                    'background-color': 'transparent',
                    'decor-color': 'transparent',
                    'lineWidth': 3,
                    'height': 204
                });
            }
            $('#signature').jSignature('reset');
        }
        else if ($("#UploadSignatureOption").val() == "True") {
            $("#innertabLink_3").addClass('active');
            $("#innertabContent_3").show();
            $("#innertabLink_1").removeClass('active');
            $("#innertabLink_2").removeClass('active');
            $("#innertabLink_4").removeClass('active');
            $("#innertabContent_1").hide();
            $("#innertabContent_2").hide();
            $("#innertabContent_4").hide();
        }
        else {
            $("#innertabLink_4").addClass('active');
            $("#innertabContent_4").show();
            $("#innertabLink_1").removeClass('active');
            $("#innertabLink_2").removeClass('active');
            $("#innertabLink_3").removeClass('active');
            $("#innertabContent_1").hide();
            $("#innertabContent_2").hide();
            $("#innertabContent_3").hide();
        }
    }
    else {
        $("#innertabLink_1").addClass('active');
        $("#innertabContent_1").show();
        $("#innertabLink_2").removeClass('active');
        $("#innertabLink_3").removeClass('active');
        $("#innertabLink_4").removeClass('active');
        $("#innertabContent_2").hide();
        $("#innertabContent_3").hide();
        $("#innertabContent_4").hide();
    }
    //
    if ($("#ddlModeofSignature option").length == 0) {
        var SignatureMode = $("#hdnSignatureMode").val().split(',');
        SignatureMode.unshift("18");
        var Signoptions = "";
        for (var i = 0; i < SignatureMode.length; i++) {
            switch (parseInt(SignatureMode[i])) {
                case 3:
                    Signoptions += "<option value='3'>eSignature (Select your signature style and sign)</option>";
                    break;
                case 2:
                    Signoptions += "<option value='2'>eSign v3</option>";
                    break;
                case 1:
                    Signoptions += "<option value='1'>Digital Signature (USB Crypto token for document signing)</option>";
                    break;

                case 7:
                    Signoptions += "<option value='7'>eSign (NSDL) Powered by ZOOP.ONE</option>";
                    break;
                case 8:
                    Signoptions += "<option value='8'>eSign v2.1 (Powered by Verasys)</option>";
                    break;
                case 12:
                    Signoptions += "<option value='12'>eSign v2.1 (Powered by eMudhra)</option>";
                    break;
                case 14:
                    Signoptions += "<option value='14'>eSign v2.1 (Powered by CDSL)</option>";
                    break;
                case 18:
                    Signoptions += "<option value=''>Please select a Signature type</option>";
                    break;
            }
        }
        $("#ddlModeofSignature").append(Signoptions);
        $("#ddlModeofSignature").val('');
    }
}
function PoupInitialsLoadForInitials() {
    PouploadwdforInitials = true;
    if ($("#SelectFontOption").val() == "False") {
        if ($("#DrawSignatureOption").val() == "True") {
            var CanvasLength = $("#divInitials canvas").length;
            $("#innertabLink_In_2").addClass('active');
            $("#innertabContent_In_2").show();
            $("#innertabLink_In_1").removeClass('active');
            $("#innertabLink_In_3").removeClass('active');
            $("#innertabLink_In_4").removeClass('active');
            $("#innertabContent_In_1").hide();
            $("#innertabContent_In_3").hide();
            $("#innertabContent_In_4").hide();
            $("#hdnInitialsImageOption").val(2);
            //$("#signature").empty();
            if (CanvasLength == 0) {
                $("#divInitials").jSignature({
                    'background-color': 'transparent',
                    'decor-color': 'transparent',
                    'lineWidth': 3,
                    'height': 204
                });
            }
            $('#divInitials').jSignature('reset');
        }
        else if ($("#UploadSignatureOption").val() == "True") {
            $("#innertabLink_In_3").addClass('active');
            $("#innertabContent_In_3").show();
            $("#innertabLink_In_1").removeClass('active');
            $("#innertabLink_In_2").removeClass('active');
            $("#innertabLink_In_4").removeClass('active');
            $("#innertabContent_In_1").hide();
            $("#innertabContent_In_2").hide();
            $("#innertabContent_In_4").hide();
        }
        else {
            $("#innertabLink_In_4").addClass('active');
            $("#innertabContent_In_4").show();
            $("#innertabLink_In_1").removeClass('active');
            $("#innertabLink_In_2").removeClass('active');
            $("#innertabLink_In_3").removeClass('active');
            $("#innertabContent_In_1").hide();
            $("#innertabContent_In_2").hide();
            $("#innertabContent_In_3").hide();
        }
    }
    else {
        $("#innertabLink_1").addClass('active');
        $("#innertabContent_1").show();
        $("#innertabLink_2").removeClass('active');
        $("#innertabLink_3").removeClass('active');
        $("#innertabLink_4").removeClass('active');
        $("#innertabContent_2").hide();
        $("#innertabContent_3").hide();
        $("#innertabContent_4").hide();
    }
}

//function PoupInitialsLoadForInitials() {
//    pouploadwdforinitials = true; 
//    if ($("#SelectFontOption").val() == "false") {
//        if ($("#DrawSignatureOption").val() == "true") {
//            $("#innertabLink_in_2").addClass('active');
//            var CanvasLength = $("#divinitials canvas").length;
//            $("#innertabcontent_In_2").show();
//            $("#innertablink_In_1").removeClass('active');
//            $("#innertabLink_in_3").removeClass('active');
//            $("#innertabLink_In_4").removeClass('active');
//            $("#innertabcontent_In_1").hide();
//            $("#innertabcontent_in_3").hide();
//            $("#innertabcontent_in_4").hide();
//            $("#hdninitialsimageoption").val(2);
//            //$("#divinitials").empty();
//            if (CanvasLength == 0) { 
//                $("#divinitials").jSignature({
//                    'background-color': 'transparent',
//                    'decor-color': 'transparent',
//                    'lineWidth': 3,
//                    'height': 204
//                });
//            }
//            $('#divinitials').jSignature('reset');
//        }
//        else if ($("#uploadsignatureoption").val() == "true") {
//            $("#innertablink_in_3").addClass('active');
//            $("#innertabcontent_in_3").show();
//            $("#innertablink_in_1").removeClass('active');
//            $("#innertablink_in_2").removeClass('active');
//            $("#innertablink_in_4").removeClass('active');
//            $("#innertabcontent_in_1").hide();
//            $("#innertabcontent_in_2").hide();
//            $("#innertabcontent_in_4").hide();
//        }
//        else {
//            $("#innertablink_in_4").addClass('active');
//            $("#innertabcontent_in_4").show();
//            $("#innertablink_in_1").removeClass('active');
//            $("#innertablink_in_2").removeClass('active');
//            $("#innertablink_in_3").removeClass('active');
//            $("#innertabcontent_in_1").hide();
//            $("#innertabcontent_in_2").hide();
//            $("#innertabcontent_in_3").hide();
//        }
//    }
//    else {
//        $("#innertablink_in_1").addClass('active');
//        $("#innertabcontent_in_1").show();
//        $("#innertablink_in_2").removeClass('active');
//        $("#innertablink_in_3").removeClass('active');
//        $("#innertablink_in_4").removeClass('active');
//        $("#innertabcontent_in_2").hide();
//        $("#innertabcontent_in_3").hide();
//        $("#innertabcontent_in_4").hide();
//    }
//}

$("body").on("change", "#ddlModeofSignature", function () {

    var sId = parseInt($("#ddlModeofSignature").val());
    if (sId == 3 || sId == 2) {
        $("#div-Visualapperarance").show();
    } else {
        $("#div-Visualapperarance").hide();
    }
});

$('body').on("click", '#btnSignaturePreview', function () {
    var finaldata = "";
    var ImageData = "";
    var signedByHtmlTag = '<div class="signedby-tag" style="font-size: 8px;" id="p_signedby">Signed by [signedByName]</div>';
    signedByHtmlTag = signedByHtmlTag.replace("[signedByName]", $("#txtFullName").val() == "" ? DisplayName : $("#txtFullName").val());
    if ($("#ddlModeofSignature").val() == "3") {
        var ImageData = "";
        if (SignatureImg == "" || SignatureImg == null) {
            if ($("#hdnSignatureImageOption").val() == 1) {
                ImageData = $("#SignatureImage").val();
                finaldata = $('#Signaturedropdown .imgdetails.selected .span-label').html();
                $("#" + SelectedSignatureId).css("padding", "10px 0px");
                $(".signerName").css({ fontSize: "8px" });
            }
            else if ($("#hdnSignatureImageOption").val() == 2) {
                if ($("#signature").jSignature('getData', 'native') != 0) {
                    ImageData = $('#signature').jSignature('getData');
                    $("#" + SelectedSignatureId).css('padding', '');
                    var pageWidth = $('.documentVisual img').width();
                    var screenDisplayWidth = $('#documentViewContent').width();
                    if (pageWidth > screenDisplayWidth) {
                        finaldata = "<img class='preview-company-stamp' style='width: 45% !important;' src='" + ImageData + "' />"
                    }
                    else {
                        finaldata = "<img class='preview-company-stamp' style='width: 100% !important;' src='" + ImageData + "' />"
                    }
                }
            }
            else if ($("#hdnSignatureImageOption").val() == 3) {
                ImageData = $("#hdnPreviewesImageData").val();
                finaldata = "<img class='preview-company-stamp' style='width: 75% !important;height: 75% !important;' src='" + ImageData + "' />"
                $("#" + SelectedSignatureId).css('padding', '');
            }
            else if ($("#hdnSignatureImageOption").val() == 4) {
                ImageData = $("#hdntopozImagevalue").val();
                $('#hdnSignatureImagevisible').val(1);
                finaldata = "<img class='preview-company-stamp' style='width: 100% !important;' src='" + ImageData + "' />"
                $("#" + SelectedSignatureId).css('padding', '');
            }
        } else {
            ImageData = SignatureImg;
            finaldata = "<img class='preview-company-stamp' style='width: 100% !important;' src='" + ImageData + "' />"
            $("#" + SelectedSignatureId).css('padding', '');
        }

        if (ImageData == "") {
            ShowHidePleaseWait('N');
            $('#imgFollow').hide();
            $("#msgcontent").attr("class", "info");
            if (innertabLink == "innertabLink_1") {
                if ($("#SelectFontOption").val() == "True") {
                    $('#msgcontent').html("Please select any one font option.");
                }
            } else
                if (innertabLink == "innertabLink_2") {
                    if ($("#DrawSignatureOption").val() == "True") {
                        $('#msgcontent').html("Please Draw an image.");
                    }
                } else if (innertabLink == "innertabLink_3") {
                    if ($("#UploadSignatureOption").val() == "True") {
                        $('#msgcontent').html("Please upload an image with maximum of 200kb and minimum 100kb");
                    }
                } else if (innertabLink == "innertabLink_4") {
                    if ($("#eSignaturePadOption").val() == "True") {
                        $('#msgcontent').html("Please select Pad Option");
                    }
                }
            $("#btnmsgcancel").hide();
            $(".alertWindow").css({ 'display': "block" });
            $('#btnmsgok').html('OK');
            $('#btnmsgok').attr("href", "javascript:Returncontrol('Y','');");
            return false;
        }

        $("#hdnPreviewesImageData").val(ImageData);
        $("#" + SelectedSignatureId + " .signImg").hide();
        $("#" + SelectedSignatureId + " .signerName").html('').css('display', '');
        $("#" + SelectedSignatureId + " .email").remove();
        $("#" + SelectedSignatureId + " .signerName").show().append(finaldata).append(signedByHtmlTag);
        $(".Signatory1").each(function () {
            if ($("#" + $(this).attr('id') + " .signImg:hidden").length == 1) {
                $("#" + $(this).attr('id') + " .signerName").html('').css('display', '');
                $("#" + $(this).attr('id') + " .signerName").show().append(finaldata).append(signedByHtmlTag);
                $(this).addClass('focused');
            }
        });
    }
    else if ($("#ddlModeofSignature").val() == "") {
        $("#Signaturedropdown").modal("show");
        $("#btnmsgcancel").hide();
        $("#msgcontent").attr("class", "info");
        $('#msgcontent').html("Please select a Signature type");
        $(".alertWindow").css({ 'display': "block" });
        $('#btnmsgok').attr("href", "javascript:Returncontrol('Y','');");
        return false;
    }
    else {
        appendData = '<img style="width: 35px;height: 100%;box-shadow: none !important;" src="\\Content\\eMDMSCSS\\img\\1476729873_Check.jpg">';
        $("#" + SelectedSignatureId + " .signImg").hide();
        $("#" + SelectedSignatureId + " .email").remove();
        $("#" + SelectedSignatureId + " .signerName").html('').css('display', 'flex');
        $("#" + SelectedSignatureId + " .signerName").show().append(appendData).append(signedByHtmlTag);
        $("#" + SelectedSignatureId).css('padding', '5px');


        $(".Signatory1").each(function () {
            $("#" + $(this).attr('id')).css("padding", "");
            if ($("#" + $(this).attr('id') + " .signImg:hidden").length == 1) {
                $("#" + $(this).attr('id') + " .email").remove();
                $("#" + $(this).attr('id') + " .signerName").html('').css('display', 'flex');
                $("#" + $(this).attr('id') + " .signerName").show().append(appendData).append(signedByHtmlTag);
                $("#" + $(this).attr('id')).css('padding', '5px');
                $(this).addClass('focused');
            }
        });
    }
    $("#Signaturedropdown").modal("hide");

});

$('body').on('click', "#btnSignaftervalidateall", function () {
    var SignPlaceholdercount = $('.dragDiv .signImg').length;
    var ReviewedPlaceholdercount = $('.dragDiv .signImg:hidden').length;
    var InitialsCount = $('.Initials').length;
    var ReviewedInitialsCount = $('.Initials img').length;
    if (window.Boolean(ValidateAllPlaceholders) && SignPlaceholdercount != ReviewedPlaceholdercount) {
        $("#btnmsgcancel").hide();
        $("#msgcontent").attr("class", "info");
        $('#msgcontent').html("Please review all signature placeholder(s) on the document");
        $(".alertWindow").css({ 'display': "block" });
        $('#btnmsgok').attr("href", "javascript:Returncontrol('Y','');");
        return false;
    }

    if (window.Boolean(ValidateAllPlaceholders) && InitialsCount != ReviewedInitialsCount) {
        $("#btnmsgcancel").hide();
        $("#msgcontent").attr("class", "info");
        $('#msgcontent').html("Please review all initials placeholder(s) on the document");
        $(".alertWindow").css({ 'display': "block" });
        $('#btnmsgok').attr("href", "javascript:Returncontrol('Y','');");
        return false;
    }

    if (parseInt($("#ddlModeofSignature").val()) == 1) {
        $("#btnDigitalsign").click();
    } else if (parseInt($("#ddlModeofSignature").val()) == 2) {
        $("#signerLink_1").click();
    } else if (parseInt($("#ddlModeofSignature").val()) == 3) {
        $("#btneSignature").click();
    } else if (parseInt($("#ddlModeofSignature").val()) == 7) {
        $("#signerLink_5").click();
    } else if (parseInt($("#ddlModeofSignature").val()) == 8) {
        $("#signerLink_4").click();
    } else if (parseInt($("#ddlModeofSignature").val()) == 12) {
        $("#signerLink_7").click();
    } else if (parseInt($("#ddlModeofSignature").val()) == 14) {
        $("#signerLink_14").click();
    }
});

// Next-Previous Placeholder  -- starts //
$("#btnsignnext").on("click", function () {
    $(this).text("Next");
    PlaceholderReviewCount += 1;

    if (IndconfigDetailswithAllPage.length == configcount) {
        configcount = 0;
        isbuttonclicked = false;
    }

    pageNagivation(configcount);
    var pageNo = ($("#ddlCustomPage").val() == "" || $("#ddlCustomPage").val() == undefined) ? 1 : parseInt($("#ddlCustomPage").val());
    if (IndconfigDetailswithAllPage.length - 1 != configcount) {

        if (IndconfigDetailswithAllPage[configcount + 1].split('~')[1] == pageNo)
            $(this).text("Next");
        else
            $(this).text("Next Pg " + IndconfigDetailswithAllPage[configcount + 1].split('~')[1]).css("width", "80px");
    }

    $("#" + IndconfigDetailswithAllPage[configcount].split('~')[0] + " span.start").remove();
    $("#" + IndconfigDetailswithAllPage[configcount].split('~')[0]).addClass("focused");
    var sT = parseInt($("#" + IndconfigDetailswithAllPage[configcount].split('~')[0]).css("top").replace("px", ''));
    var documentViewHeight = $('#documentViewContent').height();

    var screenDisplayWidth = $('#documentViewContent').width();
    var screenDisplayHeight = $('#documentViewContent').height();
    var pWidth = $('.documentVisual img').width();
    var pHeight = $('.documentVisual img').height();
    if (pWidth > screenDisplayWidth) {
        $("#documentViewContent").animate({
            scrollTop: ((pageNo == 1 ? (sT - 20) : ((pageNo - 1) * prHeight) + ((pageNo - 1) * 10) + sT)) * (screenDisplayWidth / pWidth)
        }, 500);
        $("#showSignature").animate({ top: ((pageNo - 1) * pHeight) + sT + ((pageNo - 1) * 10) });
        
    } else {
        if (sT > documentViewHeight) {
            prHeight = $('.documentVisual img').height();
            var Pagelength = parseInt($("#hdnNoOfPages").val());
            if (Pagelength == pageNo) {
                $("#showSignature").animate({ top: documentViewHeight - 70 });
            }
            else {
                $("#showSignature").animate({ top: -10 });
            }
            $('#documentViewContent').animate({
                scrollTop: pageNo == 1 ? (sT - 20) : ((pageNo - 1) * prHeight) + ((pageNo - 1) * 10) + sT
            }, 500);
        }
        else if ((sT > 30) || (sT < documentViewHeight)) {
            $("#showSignature").animate({ top: sT });
            i = "#page_" + pageNo;
            f = $(i).offset().top + $("#documentViewContent").scrollTop() - 120;
            $("#documentViewContent").animate({
                scrollTop: f
            }, 500);
        }
        else {
            $("#showSignature").animate({ top: 10 });

        }

    }



    if (IndconfigDetailswithAllPage.length - 1 == configcount) {

        $(this).text("Next Pg " + IndconfigDetailswithAllPage[0].split('~')[1]).css("width", "80px");
        $("#SignatureReviewed_" + $("#documentid").val()).val("True");
    }
    if (IndconfigDetailswithAllPage.length == 1) {
        $('#btnsignnext').hide();
    }
    configcount = configcount + 1;
});

function ShowfirstPlacehpolder() {
    if (IndconfigDetailswithAllPage.length != 0) {
        var pageNo, i, f;
        // var sdetails = IndconfigDetailswithAllPage[0].split('_');
        pageNo = parseInt(IndconfigDetailswithAllPage[0].split('~')[1]);
        i = "#page_" + pageNo;
        $("#ddlPage").val(pageNo);
        f = $(i).offset().top + $("#documentViewContent").scrollTop() - 120;
        $("#documentViewContent").animate({
            scrollTop: f
        });

        if (IndconfigDetailswithAllPage.length > 1 && parseInt(IndconfigDetailswithAllPage[1].split('~')[1]) != pageNo) {
            $("#btnsignnext").text("Next Pg " + IndconfigDetailswithAllPage[1].split('~')[1]).css("width", "80px");
        }
        if (IndconfigDetailswithAllPage.length == 1) {
            $("#" + IndconfigDetailswithAllPage[0].split('~')[0] + " span.start").remove();
            $("#" + IndconfigDetailswithAllPage[0].split('~')[0]).addClass("focused");
        }
        var sT = parseInt($("#" + IndconfigDetailswithAllPage[0].split('~')[0]).css("top").replace("px", ''));
        if (sT > 700) {
            $("#showSignature").animate({ top: sT - 120 });
        }
        else if ((sT > 30) || (sT < 700)) {
            $("#showSignature").animate({ top: sT - 120 }); //sT - 60
        }
        else {
            $("#showSignature").animate({ top: 0 });
        }
        $('html, body').animate({
            scrollTop: sT - 360
        }, 1000);
        if (IndconfigDetailswithAllPage.length - 1 == configcount) {
            $("#btnsignpre").show();
            $('#btnsignnext').hide();
        }
        else {
            if (configcount == 0) {
                $('#btnsignpre').hide();
            }
            else {
                $('#btnsignpre').show();
            }
            $('#btnsignnext').show();
        }
    }
    if (IndconfigDetailswithAllPage.length > 1) {
        $("#showSignature").show();
    }
    if (IndconfigDetailswithAllPage.length == 1) {
        $('#btnsignnext').hide();
        $('#btnsignpre').hide();
        // $("#SignatureReviewed_" + $("#documentid").val()).val("True");
    }
}

function LoadNextPlaceholder(IndConfigDetails) {
    if (IndConfigDetails.length != 0) {
        isbuttonclicked = false;
        $("#btnsignpre").hide();
        $('#btnsignnext').show();
        $("#btnsignnext").text("Next");
        PlaceholderReviewCount += 1;
        if (IndConfigDetails.length - 1 == configcount) {
            configcount = 0;
            isbuttonclicked = false;
        }
        if (configcount == 0 && isbuttonclicked == false) {
            //ShowfirstPlacehpolder();
            if (IndConfigDetails.length > 0) {
                isbuttonclicked = true;
                var firstPageNo, i, f;
                firstPageNo = 1;
                i = "#page_" + firstPageNo;
                $("#ddlPage").val(firstPageNo).change();
                f = $(i).offset().top + $("#documentViewContent").scrollTop() - 120;
                $("#documentViewContent").animate({
                    scrollTop: f
                }, "slow");
                $("#showSignature").animate({ top: 0 });
            }
            return false;
        }
    }
    else {
        $("#btnsignpre").hide();
        $('#btnsignnext').hide();
    }
}

function pageNagivation(count) {
    var pageNo, i, f;
    pageNo = parseInt(IndconfigDetailswithAllPage[count].split('~')[1]);
    i = "#page_" + pageNo;
    $("#ddlCustomPage").val(pageNo);
    f = $(i).offset().top + $("#documentViewContent").scrollTop() - 120;
    //$("#documentViewContent").animate({
    //    scrollTop: f
    //}, 500);
}
// Next-Previous Placeholder  -- ends //
function GetCustomCoordninatesByText(SearchText, Anchor, InitialsText, InitialsAnchor) {
    $.ajax({
        url: GetCustomCoordinates,
        type: "POST",
        dataType: "json",
        async: false,
        data: { "SearchText": SearchText, "Anchor": Anchor, "FileName": $("#hdnFileFullPath").val(), "InitialsSearchText": InitialsText, "InitialsAnchor": InitialsAnchor, __RequestVerificationToken: $('[name= "__RequestVerificationToken"]').val() },
        success: function (data) {
            SignatureCoordinates = data.SignatureCoordinates;
            InitialsCoordinates = data.InitialsCoordinates;

        },
        error: function (e) {

        }
    });
} ``
function CreatePageLevelSignatoryUsingSearchtext(Coordinates) {
    var currentId = 1;
    //var Height = 60, Width = 120;
    var imageHeight = $('.documentVisual img').height();
    var sCoordinates = Coordinates.split(';');
    for (var j = 0; j < sCoordinates.length; j++) {
        var cd = sCoordinates[j].split(',');
        var left = Number(cd[1]);
        var top = Number(cd[2]);
        var Height = Number(cd[4]);
        var Width = Number(cd[3]);
        var finalTop = imageHeight - top;
        var finalHeight = (Number(top) - Number(Height));
        var finalWidth = (Number(Width) - Number(left));
        $('#page_' + cd[0]).append('<div id="draggableDiv_' + (j + 1) + '_' + cd[0] + '" class="dragDiv Signatory' + currentId + '" style="left:' + left + 'px; top:' + finalTop + 'px;height:' + finalHeight + 'px;width:' + finalWidth + 'px;"><span class="signImg"></span><span class="signerName" style="display:none;"></span><p class="email">(S' + (j + 1) + ')</p></div>');
        if (IsCustomized == "True") {
            $('.dragDiv').draggable({ containment: "#signerContainment", scroll: false, stop: function () { UpdateCoordinates(this); } });
            $('.dragDiv').resizable({ containment: "#signerContainment", maxHeight: 250, maxWidth: 350, minHeight: 60, minWidth: 120, stop: function () { UpdateCoordinates(this); } });
        }
        //if (ValidateAllPlaceholders == "True") {
        //    var config = { PageNo: cd[0], Topvalue: finalTop, DivId: "draggableDiv_" + (j + 1) + "_" + cd[0] + "~" + cd[0] };
        //    IndconfigDetailswithAllPage.push(config);
        //}
    }

    var config = "";
    $('.Signatory' + currentId).each(function () {
        var Page = $(this).attr('id').split('_')[2];

        var id1 = $(this)[0];
        var Width = id1.offsetWidth;
        var Height = id1.offsetHeight;
        var Left = id1.offsetLeft;
        var Top = id1.offsetTop;
        Top = $('.documentVisual img').height() - Top;
        Height = (Number(Top) - Number(Height));
        Width = (Number(Left) + Number(Width));
        config += Page + ',' + Left + ',' + Top + ',' + Width + ',' + Height + ';';

        Coordinates = Page + ',' + Left + ',' + Top + ',' + Width + ',' + Height;
        updCord = "true";
        customselectPage = "true";
    });
    config = config.substring(0, config.length - 1);
    var pageNumbers = config;
    $("#hdnPagelevelCordinates").val(pageNumbers);
    $("#hdnCoordinates").val(pageNumbers);
    $("#ddlPageSelection").val("PAGE LEVEL");
    $("#customsignerdiv").hide();
    if (IsCustomized == "True") {
        $('.Signatory' + currentId).draggable({ disabled: false }).resizable({ disabled: false });
    }
    else {
        $('.Signatory' + currentId).draggable({ disabled: true }).resizable({ disabled: true });
    }

    $(".documentVisual").each(function () {
        var n = $(this).attr("id"),
            t = n.split("_")[1].toString();
        $(this).droppable({
            accept: ".dragDiv",
            drop: function (n, t) {
                var a, v, r, i, o;
                if ((i = $(this).attr("id").split("_")[1], r != i)) {
                    var w = t.draggable.html(),
                        e = "#" + t.draggable.attr("id"),
                        s = $("#page_" + i).offset().left,
                        y = $("#page_" + i).offset().top,
                        p = $(e).offset().left,
                        h = $(e).offset().top,
                        c = parseInt(p) - parseInt(s),
                        l = parseInt(h) - parseInt(y);
                    $(e).appendTo($("#page_" + i)),
                        $(e).css("left", c + "px"), $(e).css("top", l + "px"),
                        o = t.draggable.attr("id").split("_")[2],
                        $("#fieldPagination_" + o).val(i);
                }
            }
        });
    });

    if (ValidateAllPlaceholders == "True") {
        GetAllPlaceholdersID();
    }
}
function CreatePageLevelInitialsUsingSearchtext(Coordinates) {
    var currentId = 1;

    var imageHeight = $('.documentVisual img').height();
    var sCoordinates = Coordinates.split(';');
    for (var j = 0; j < sCoordinates.length; j++) {
        var cd = sCoordinates[j].split(',');
        var left = Number(cd[1]);
        var top = Number(cd[2]);
        var Height = Number(cd[4]);
        var Width = Number(cd[3]);
        var finalTop = imageHeight - top;
        var finalHeight = (Number(top) - Number(Height));
        var finalWidth = (Number(Width) - Number(left));
        $('#page_' + cd[0]).append('<div id="draggableDiv_In_' + (j + 1) + '_' + cd[0] + '" class="dragDiv Initials" style="left:' + left + 'px; top:' + finalTop + 'px; height:' + finalHeight + 'px; width:' + finalWidth + 'px;"><span class="InImg">In</span><p class="email"></p></div>');//(I' + id + ')
        if (InitialsCustomized == "True") {
            $('.Initials').draggable({ containment: "#signerContainment", scroll: false, stop: function () { UpdateInCoordinates(this); } });
            $('.Initials').resizable({
                containment: "#signerContainment", minHeight: 32,
                maxHeight: 88,
                minWidth: 34,
                maxWidth: 99, stop: function () { UpdateInCoordinates(this); }
            });
        }
    }
    var config = "";
    $(".Initials").each(function () {
        var Page = $(this).attr('id').split('_')[3];
        var id1 = $(this)[0];
        var Width = id1.offsetWidth;
        var Height = id1.offsetHeight;
        var Left = id1.offsetLeft;
        var Top = id1.offsetTop;
        Top = $('.documentVisual img').height() - Top;
        Height = (Number(Top) - Number(Height));
        Width = (Number(Left) + Number(Width));
        config += Page + ',' + Left + ',' + Top + ',' + Width + ',' + Height + ';';

        Coordinates = Page + ',' + Left + ',' + Top + ',' + Width + ',' + Height;
        updIncCord = "true";
        //customselectPage = "true";
    });

    config = config.substring(0, config.length - 1);
    var pageNumbers = config;
    $("#InitialsPagelevelCordinates").val(pageNumbers);
    $("#InitialsPagelevelCordinates").val(pageNumbers);
    $("#hdnInitialsCoordinates").val(pageNumbers);
    $("#InitialsPageNumbers").val(pageNumbers);
    $("#ddlInitialsPageSelection").val("PAGE LEVEL");
    $("#SelectInitialsPage").val("PAGE LEVEL");
    $("#InitialsPosition").val("");
    $("#customInitialdiv").hide();
    if (InitialsCustomized == "True") {
        $('.Initials').draggable({ disabled: false }).resizable({ disabled: false });
    }
    else {
        $('.Initials').draggable({ disabled: true }).resizable({ disabled: true });
    }


    $(".documentVisual").each(function () {
        var n = $(this).attr("id"),
            t = n.split("_")[1].toString();
        $(this).droppable({
            accept: ".dragDiv",
            drop: function (n, t) {
                var a, v, r, i, o;
                if ((i = $(this).attr("id").split("_")[1], r != i)) {
                    var w = t.draggable.html(),
                        e = "#" + t.draggable.attr("id"),
                        s = $("#page_" + i).offset().left,
                        y = $("#page_" + i).offset().top,
                        p = $(e).offset().left,
                        h = $(e).offset().top,
                        c = parseInt(p) - parseInt(s),
                        l = parseInt(h) - parseInt(y);
                    $(e).appendTo($("#page_" + i)),
                        $(e).css("left", c + "px"), $(e).css("top", l + "px"),
                        o = t.draggable.attr("id").split("_")[2],
                        $("#fieldInPagination_" + o).val(i);
                }
            }
        })
    })


    var InitialsVisualizationId = parseInt($("#hdnInitialsImageOption").val());
    var InitialImage = $("#InitialsImage").val();
    if (InitialImage != "" && InitialImage != undefined) {
        var initialimagedata = "";
        if (InitialsVisualizationId == 1) {
            initialimagedata = '<img style="box-shadow: none !important;height: 100%;" src="' + InitialImage + '">';
        }
        else {
            initialimagedata = '<img style="width: inherit;box-shadow: none !important;height: 100%;" src="' + InitialImage + '">';
        }
        $(".Initials img").remove();
        $(".Initials span").html('');
        $(".Initials").append(initialimagedata);
        $(".dragDiv.Initials").addClass("focused");
    }

    if (ValidateAllPlaceholders == "True") {
        GetAllPlaceholdersID();
    }

}

function GetAllPlaceholdersID() {
    IndconfigDetailswithAllPage.length = 0;
    $('.dragDiv').each(function () {
        //var id = $(this).attr('id').split('_');
        var PageNo = $(this).parent().attr('id').split('_')[1];
        var Top = $(this).css('top').replace("px", '');
        var config = { PageNo: PageNo, Topvalue: Top, DivId: $(this).attr('id') + "~" + PageNo };
        IndconfigDetailswithAllPage.push(config);
    });
    IndconfigDetailswithAllPage = IndconfigDetailswithAllPage.sort(function (x, y) { return x.Topvalue - y.Topvalue; }); //RearrangeTheIndConfigDetails();
    IndconfigDetailswithAllPage = IndconfigDetailswithAllPage.sort(function (x, y) { return x.PageNo - y.PageNo; }); //RearrangeTheIndConfigDetails();
    var cfig = new Array();
    IndconfigDetailswithAllPage.forEach(function (item) { var val = item.DivId; cfig.push(val); });
    IndconfigDetailswithAllPage.length = 0;
    IndconfigDetailswithAllPage = cfig;
}